### 内結合(INNER JOIN)
内結合は等結合と同じ結果が得られる演算。
例えば、社員の表と部門の表と社員表の部門コードをキーとして結合するコードは以下となる。
```SQL
SELECT 社員表.社員コード, 社員表.社員名, 部門表.部門コード, 部門表.部門名　FROM　社員
INNER JOIN 部門表　ON 社員表.部門コード　= 部門表.部門コード
```

社員表

| 社員コード | 社員名 | 部門コード |
| ---------- | ------ | ---------- |
| 12345      | AAA    | A123       |
| 12346      | BBB    | A124       |
| 12347      | CCC    | B121       |

部門表

| 部門コード | 部門名 |
| ---------- | ------ |
| A123       | A-De   |
| A124       | B-De   |
| A125           |C-De        |

出力結果

| 社員コード | 社員名 | 部門コード | 部門名 |
| ---------- | ------ | ---------- | ------ |
| 12345      | AAA    | A123       | A-De   |
| 12346      | BBB    | A124       | B-De   |

以上例から、CCCの部門コードは部門表では一致する結果を見つけなかったので、出力結果は２行のみとなる。

### 外結合(OUTER JOIN)
内結合は、結合列の値が等しい行だけ取り出す演算で、これに対して、結合列の値が一致しない行でも取り出せる演算は外結合となる。
外結合では、結合相手の表に該当行がない場合は、それをNULLで埋めて結合する。
外結合は以下の３種類がある。

| 結合種類   | 内容                                                                                                                               |  
| ---------- | ---------------------------------------------------------------------------------------------------------------------------------- | 
| 左外結合   | `LEFT OUTER JOIN`キーワードの前（左）に記述した表を基準にし、JOINの後(右)に記述した表に存在しない行をNULLで埋め合わせて結合する。  |    
| 右外結合   | `RIGHT OUTER JOIN`キーワードの後（右）に記述した表を基準にし、JOINの前(左)に記述した表に存在しない行をNULLで埋め合わせて結合する。 |     
| 完全外結合 | `FULL OUTER JOIN`左外結合と右外結合を組み合わせた演算、片方にのみ存在する場合は、もう片方をNULLで埋め合わせて結合する。            |     


#### 左外結合
先と同じ社員、部門表で`LEFT JOIN`を出力しする結果は以下となる。
```SQL
SELECT 社員表.社員コード, 社員表.社員名, 部門表.部門コード, 部門表.部門名　FROM　社員
LEFT OUTER JOIN 部門表　ON 社員表.部門コード　= 部門表.部門コード
```

| 社員コード | 社員名 | 部門コード | 部門名 |
| ---------- | ------ | ---------- | ------ |
| 12345      | AAA    | A123       | A-De   |
| 12346      | BBB    | A124       | B-De   |
| 12347      | CCC    | NULL       | NULL   |

`LEFT OUTER JOIN`はJOIN前の表を基準とするので、JOIN前の表（社員表）だと、12347が存在するが、部門表とリンクするキーとなる部門コードは部門表では存在しないので、出力結果はNULLとなる。

### 右外結合
同じ表を`RIGHT OUTER JOIN`で出力結果は以下となる。
```SQL
SELECT 社員表.社員コード, 社員表.社員名, 部門表.部門コード, 部門表.部門名　FROM　社員

RIGHT OUTER JOIN 部門表　ON 社員表.部門コード　= 部門表.部門コード
```

| 社員コード | 社員名 | 部門コード | 部門名 |
| ---------- | ------ | ---------- | ------ |
| 12345      | AAA    | A123       | A-De   |
| 12346      | BBB    | A124       | B-De   |
| NULL      | NULL    | A125       | C-De   |

`RIGHT OUTER JOIN`は右の表を基準として左の表と結合するので、左の表（社員表）に存在しない部門コードA125はここでNULLで埋め合わされて出力される。

### 完全外結合
同じ表を完全外結合で出力した結果は以下となる
```SQL
SELECT 社員表.社員コード, 社員表.社員名, 部門表.部門コード, 部門表.部門名　FROM　社員

FULL OUTER JOIN 部門表　ON 社員表.部門コード　= 部門表.部門コード
```

| 社員コード | 社員名 | 部門コード | 部門名 |
| ---------- | ------ | ---------- | ------ |
| 12345      | AAA    | A123       | A-De   |
| 12346      | BBB    | A124       | B-De   |
| NULL       | NULL   | A125       | C-De   |
| 12347      | CCC    | NULL       | NULL   |

社員表に存在しない部門のデータと部門表に存在しない社員のデータはここでNULLで埋め合わせて出力された。

社員CCCは社員表にはB121という部門コードはあるが、`SELECT`のColumnが部門表.部門コードである限り、部門表に該当コードが存在しないため、出力されない。
この存在しない部門コードを出力するには例えばColumnを社員表.部門コードに変更する手はあるが、現状のQueryの上`COALESC`という関数を使用することもできる。

### COALESC
`COALESC`は2つの関数に渡された二つの値を比較し、片方がNULLであれば、もう片方のNULLではない値を返すことができる。両方がNULLの場合は、NULLを返す。
同じ表に`COALESC`を使ったコードは以下となる：
```SQL
SELECT 社員表.社員コード, 社員表.社員名, COALESC(部門表.部門コード,社員表.部門コード), 部門表.部門名　FROM　社員
FULL OUTER JOIN 部門表　ON 社員表.部門コード　= 部門表.部門コード
```

| 社員コード | 社員名 | 部門コード | 部門名 |
| ---------- | ------ | ---------- | ------ |
| 12345      | AAA    | A123       | A-De   |
| 12346      | BBB    | A124       | B-De   |
| NULL       | NULL   | A125       | C-De   |
| 12347      | CCC    | ==B121==       | NULL   |

### 自己接合

自己接合は表の各属性にAliasを設定し、表に自分の内容を結合する方式。
例えば以下の表では、表の中に上司という属性に、この社員表の主キーである社員コードが記載されている、各社員の上司を出力するためには、自己結合が使われる。

| 社員コード | 社員名 | 上司 |
| ---------- | ------ | ---------- |
| 12345      | AAA    | NULL       |
| 12346      | BBB    | 12345       |
| 12347      | CCC    | 12346       |

```SQL
SELECT S1.社員名 AS 社員名, S2.社員名 AS 上司名
FROM 社員表 AS S1
INNER JOIN 社員表 AS S2 ON S1.上司 = S2.社員コード
```

これで以下の出力が得られる

| 社員名 | 上司名 |
| ------ | ------ |
| BBB    | AAA    |
| CCC    | BBB    |

### 三つの表を結合する

例えば前記以下2表の他に、売上表を追加し、AAA社員の売り上げを出力したい場合は：

社員表

| 社員コード | 社員名 | 部門コード |
| ---------- | ------ | ---------- |
| 12345      | AAA    | A123       |
| 12346      | BBB    | A124       |
| 12347      | CCC    | B121       |

部門表

| 部門コード | 部門名 |
| ---------- | ------ |
| A123       | A-De   |
| A124       | B-De   |
| A125           |C-De        |

売上表

| 社員コード | 売り上げ |
| ---------- | -------- |
| AAA        | 1000     |
| BBB        | 1500     |

表結合の方式では以下のコードとなる
```SQL
SELECT E.社員コード, D.部門名, S.売り上げ
FROM 社員表 E 
INNER JOIN 部門名 D ON E.部門コード = D.部門コード
INNER JOIN 売り上げ S ON E.社員コード = S.社員コード
WHERE E.社員コード = 12345
```
表結合方式以外では、`WHERE`記述で同じ結果を達成することもできる
```SQL
SELECT E.社員コード, D.部門名, S.売り上げ
FROM 社員表 E,部門名 D,売上表 S
WHERE E.部門コード = D.部門コード
AND E.社員コード = S.社員コード
AND E.社員コード = 12345
```
