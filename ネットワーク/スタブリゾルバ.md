スタブリゾルバは、一般的にクライアントデバイス（パソコンやスマートフォンなど）上で動作する比較的単純なDNSクライアントです。以下の特徴があります：

- 再帰的なDNS解決を自身では行わない
- DNSクエリをフルサービスリゾルバに転送する
- キャッシュ機能が限定的または存在しない
- OS内部に組み込まれていることが多い
## スタブリゾルバとフルサービスリゾルバ間の通信リスク

これらの間の通信は伝統的に暗号化されていませんでした。これにより以下のセキュリティリスクが発生します：

1. **盗聴リスク**: 第三者がDNSクエリを傍受し、ユーザーの閲覧履歴を把握できる
2. **中間者攻撃**: 攻撃者がDNSレスポンスを改ざんし、悪意のあるサイトにユーザーを誘導できる
3. **プライバシー侵害**: ISPや攻撃者がユーザーの行動パターンを分析できる
4. **検閲**: 不正なDNSレスポンスにより特定のウェブサイトへのアクセスを制限できる

## DNS over TLSによる解決策

DNS over TLS (DoT)は、このスタブリゾルバとフルサービスリゾルバ間の通信を保護するために開発されました：

- **暗号化**: TLSプロトコルによりDNSクエリとレスポンスを暗号化
- **完全性保証**: 通信内容の改ざんを防止
- **認証**: フルサービスリゾルバの身元を証明し、偽装を防止
- **TCP/853ポート**: 標準でTCPの853ポートを使用

## DNS over TLSが特にスタブ-フルサービス間の通信を対象とする理由

1. **最もセキュリティが脆弱な区間**: クライアントからフルサービスリゾルバまでの経路はエンドユーザーの制御が最も及びにくく、攻撃に対して脆弱
2. **プライバシー保護**: ユーザーの個人情報（閲覧サイト履歴など）が最も露出するリスクが高い区間
3. **実装の実現可能性**: フルサービスリゾルバと権威サーバー間の全ての通信を暗号化するよりも、スタブとフルサービス間の暗号化は技術的に実装しやすい
4. **効果的なセキュリティ対策**: この区間を保護するだけでも、多くのセキュリティおよびプライバシーリスクを大幅に軽減可能