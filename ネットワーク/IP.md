#IP
IP（Internet protocol)はインターネット仕組み上、ネットワーク層のプロトコル。
次の三つの特徴を持っている：
　パケット通信技術である
　#コネクションレス型 通信である
　IPアドレスを使った経路制御を行う
>[!コネクション型]
>コネクション型通信は：相手の確認と通信経路の確認をしてから通信を開始する方式、例として以下がある：
>電話通信: 伝統的な有線および無線の電話通信は、送信者と受信者間で直接の通話路が確立されます。これは、クラシックなコネクション型通信の一例です。
>TCP（Transmission Control Protocol）: インターネット上でデータを送信するための主要なプロトコルで、送信者と受信者間に信頼性の高いコネクションを確立します。データはパケットに分割され、各パケットは送信者から受信者へ順序正しく送られます。
>ATM（Asynchronous Transfer Mode）: ATMは、小さな固定サイズのセルを使用するコネクション型通信ネットワークサービスです。ATMは、音声、ビデオ、データなどの異なる種類のトラフィックをサポートします。
>フレームリレー: デジタルネットワークを介したパケットスイッチング通信サービスで、特定のパスが確立され、それがデータ伝送のために使われます。これは、ネットワーク上でリソースを効率的に使用するためのもので、特にデータが大量にやり取りされる企業環境によく使用されます。

>[!コネクションレス型]
>UDP（User Datagram Protocol）: UDPはインターネット上でデータを送信するための主要なプロトコルの一つで、送信者と受信者間に事前にコネクションを確立せずにデータを送信します。これにより、データ送信の遅延が少なくなりますが、パケットの到達順序や到達自体の保証はありません。
>IP（Internet Protocol）: IPはインターネットの基本的なプロトコルで、データをパケットに分割し、それぞれを個別に送信します。これはコネクションレス型で、各パケットはそれぞれが目的地に到達するための最善の経路を見つけます。
>電子メール: 電子メールもまた一種のコネクションレス型通信です。メールは送信者から受信者へと配信されますが、これはメールが一度に送信され、その後メールサーバがそれを受信者へと転送する、というプロセスを通じて行われます。送信者と受信者間で直接的なコネクションは確立されません。
>HTTP（Hypertext Transfer Protocol）: HTTPはウェブブラウジングに使われるプロトコルで、クライアント（通常はウェブブラウザ）がサーバにリクエストを送信し、サーバがそれに応答します。HTTP/1.0では、各リクエストとレスポンスのために新たなコネクションが確立されます。

 IPはネットワークを超えた通信を提供する機能を持っている、ネットワークとネットワークを接続するルータはIPアドレスを手がかりに通信の振り分けを行う。これは #ルーティング といい、
 例えば以下の通り：
 　ルータのルーティングとは、データパケットが送信元から目的地まで適切に送られるためのパスを決定する過程を指します。ルータはそのための「ルーティングテーブル」を持ち、これに基づいて各パケットを適切な次のホップ（経路）へと転送します。

　例えば、仮に以下のような簡単なネットワークを考えてみましょう。

- ネットワークA（10.0.0.0/24）とネットワークB（10.0.1.0/24）が存在します。
- これら2つのネットワークは、ルータR1で接続されています。
- ネットワークAにはコンピュータA（IPアドレス: 10.0.0.2）、ネットワークBにはコンピュータB（IPアドレス: 10.0.1.2）が存在します。
- ルータR1のネットワークA側のインターフェースにはIPアドレス10.0.0.1、ネットワークB側のインターフェースにはIPアドレス10.0.1.1が割り当てられています。

　コンピュータAからコンピュータBへパケットを送信する場合、以下のようなルーティングが行われます。

1. コンピュータAはパケットの宛先IPアドレス（10.0.1.2）を見て、これが自分と同じネットワークにないことを認識します。よって、コンピュータAはパケットを自身のデフォルトゲートウェイであるルータR1（10.0.0.1）に向けて送信します。

2. ルータR1はパケットを受け取り、宛先IPアドレスをルーティングテーブルと比較します。ルータR1のルーティングテーブルは、10.0.0.0/24へのトラフィックはネットワークAのインターフェースに、10.0.1.0/24へのトラフィックはネットワークBのインターフェースに転送するというルールを持っています。

3. ルータR1はこのルールに基づき、パケットをネットワークBのインターフェースに転送します。

4. ネットワークBのインターフェースからパケットはコンピュータBへと送られ、

　通信が完了します。

　以上が、ルータによるルーティングの一例です。このように、ルータは複数のネットワークを接続し、パケットが正確に目的地まで届くようにルーティングを行います。

 #IPヘッダ
 IPパケットには以下のようなヘッダが含まれている、その内容と実際のヘッダの形は以下
 
	 0                   1                   2                   3   
	0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 
	+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
	|Version|  IHL  |Type of Service|          Total Length         |
	+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
	|         Identification        |Flags|      Fragment Offset    |
	+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
	|  Time to Live |    Protocol   |         Header Checksum       |
	+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
	|                       Source Address                          |
	+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
	|                    Destination Address                        |
	+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
	|                    Options                    |    Padding    |
	+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
	
	0                   1                   2                   3   
	0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 
	+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
	|   4   |   5   |      0x00     |             0x28             |
	+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
	|           0x1c              | 0 |        0x4000              |
	+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
	|     64        |      6        |          0xb861              |
	+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
	|            192.0.2.1                         |
	+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
	|            203.0.113.0                       |
	+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
	
　IPv4ヘッダの項目：
　#TTL ：生存時間、パケットの生存時間を表す、パッケトの永久ループを避けるため、パッケトがルータを通過するごとに１減らし、０になったらパケット破棄するとともに送信元にICMPタイプ11のメッセージを送り、時間切れによるパケット破棄を伝える。

　#プロトコル番号　：TCPなどの上位プロトコルを示す番号、番号枠は（10進）０−２５５で、主要プロトコルは
　　ICMP：１
　　TCP：６
　　UDP：１７
　　IPv6: ４１

　#ヘッダチェックサム　：これによりIPヘッダに誤りがないかを確認。


### IPアドレス
ネットワーク層のプロトコルIPで利用されるノードを特定するためのアドレス。インターネットに接続するノードは、インターネット上で一意のIPアドレスを持つ必要がある。
IPアドレスは各国のNICが割り当てなどの管理を行う。インターネットに接続する場合は、ISPに申請し、IPアドレスを取得する。

IPアドレスは32桁の2進数を8ビットで区切って10進数で表現する。
IPv4のアドレスは左からの8〜24ビットをネットワークアドレス部と呼び、右の24〜8ビットをホストアドレス部と呼ぶ。
`11011011 01100101 11000110`(ネットワークアドレス) `00000100`(ホストアドレス)

ネットワークアドレスは企業などの組織単位のネットワークの場合、そのネットワークを一意に識別するための部分である。同じネットワークに属するノードのネットワークアドレスは一意である。

ホストアドレスは、同じネットワークに属するノードを一意に識別するため部分である。

### IPアドレスクラス
IPアドレスクラスは、IPアドレス先頭４ビットまでの値によって4つのクラスが分けられている、クラスによっては、ホストアドレスがビットが多く、同一ネットワーク内のアドレス数も多くなる。

クラスA(先頭ビット0):ネットワークアドレス（8bit),ホストアドレス(24bit)
　ネットワーク内のアドレス数：16777214
クラスB(先頭ビット10):16bit,16bit
　ネットワーク内のアドレス数：65534
クラスC(先頭ビット110):24bit,8bit
　ネットワーク内のアドレス数：254
クラスD(先頭ビット1110):
　クラスD IPアドレスは、マルチキャスト（Multicast）通信に使用される特殊なタイプのIPアドレスです。IPv4アドレッシングのスキームにおいて、クラスDのアドレス範囲は224.0.0.0から239.255.255.255までです。
　1. **マルチキャスト用途**: クラスDのIPアドレスは、一つのソースから複数のデスティネーションにデータを送信するためのものです。これは、ブロードキャスト（すべてのデバイスに送信）やユニキャスト（一つの特定のデバイスに送信）とは異なります。
    
    **例**: IPTVサービスやビデオ会議システムでのデータストリーミングに使用されます。

### 特殊なIPアドレス
- ネットワークアドレス
  ホストアドレス部がすべて0のアドレスはネットワーク自体を指すネットワークアドレスである。
- ブロードキャストアドレス
  ホストアドレス部がすべて1のアドレスは、それネットワーク内すべてのノードアテとするブロードキャストアドレスである。
- ループバックアドレス
  `127.0.0.1`自分自身を表すアドレス。
- グローバルIPとプライベートIP
  インターネットに接続されたノードに一意に割り当てられたIPアドレスをグローバルIPアドレスという
  組織内のみ通用するIPをプライベートIPアドレスという、
  プライベートIPは以下の範囲での利用が推奨される
  クラスA：
  `10.0.0.0`~`10.255.255.255`
  クラスB：
  `172.16.0.0`~`172.31.255.255`
  クラスC:
  `192.168.0.0`~`192.168.255.255`
![[過去問#^72f2e0]]
![[過去問#^globalip--]]