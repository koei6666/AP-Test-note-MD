S/MIME:MIMEは日本語などの２バイトデータや画像データをSMTPメールで扱えるように機能拡張したものである、送信データはBase64などでASCII文字列に変換される。S/MIMEはMIMEをさらに拡張し、メールの暗号化とデジタル署名の機能を提供する。S/MIMEではメール本文の暗号化に共通鍵を用い、共通鍵の受け渡しには認証局が保証する公開鍵を用いる。 ^36f445

S/MIMEの特徴はend-to-endのセキュリティーを確保できること。

S/MIMEの導入にあたって、特殊のS/MIME証明書を、S/MIME利用するすべてのクライアントに発行するひつようがある（TLS証明書と違って、S/MIMEはドメイン名の代わりに、メールアドレスを登録する、そしてTLS証明書がwebサーバなどにインストールされているのに対して、S/MIMEはメールクライアントにインストールされる。）

## S/MIMEの利点
### 機密性の確保
S/MIMEはメールの内容を暗号化するため、第三者がメールを傍受しても内容を読むことができません。これにより、機密情報の漏洩を防ぎます。
### なりすまし防止
電子署名により、送信者の身元を確認できるため、なりすましメールを防止できます。受信者は送信者の公開鍵で署名を検証し、送信者の正当性を確認できます。
### 改ざん検知
電子署名はメールの内容が改ざんされていないかを確認する役割も持ちます。メールが途中で改ざんされた場合、署名が一致しなくなり、受信者に警告が表示されます。
### 導入コストの削減
多くのメールクライアントやサーバーで標準的にサポートされているため、導入コストが抑えられます。
### フィッシング詐欺対策
S/MIMEはフィッシング詐欺やスプーフィング攻撃に対するセキュリティを強化します。これにより、受信者は信頼性の高いメールを安全に受信できます。


## S/MIMEを使用したメールの送受信の流れ

### 送信側の流れ

1. **共通鍵の生成**  
    メールの内容を暗号化するための共通鍵を生成します。
    
2. **メールの暗号化**  
    共通鍵を使用してメールの内容を暗号化します。
    
3. **共通鍵の暗号化**  
    受信者の公開鍵を使用して共通鍵を暗号化します。
    
4. **電子署名の付与**  
    送信者の秘密鍵を使用してメールに電子署名を付与します。
    
5. **メールの送信**  
    暗号化されたメールと共通鍵を送信します。
    

### 受信側の流れ

1. **メールの受信**  
    暗号化されたメールを受信します。
    
2. **共通鍵の復号**  
    自身の秘密鍵を使用して共通鍵を復号します。
    
3. **メールの復号**  
    復号した共通鍵を使用してメールの内容を復号します。
    
4. **電子署名の検証**  
    送信者の公開鍵を使用して電子署名を検証し、メールの真正性を確認します。
    

## メーリングリストサービス利用時におけるS/MIMEの実装
メーリングリストサービスでは、受信したメールをMLサーバで一回中継し、ML対象の多数のアカウントに転送する必要があるので、S/MIMEの実装も多段階式になる。

1.送信者 -> MLサーバ
送信者がMLサーバに対して通常のようなS/MIME暗号化メールを送信、MLサーバの公開鍵でメールを暗号化。
!MLサーバはS/MIME証明書を事前に用意する必要がある

2.MLサーバでの処理
MLサーバが自分の秘密鍵を使ってメールを復号し、MLに登録されているメンバーの公開鍵でそれぞれ暗号化する
!MLサーバに事前にMLメンバーそれぞれの公開鍵を登録する必要がある

3.転送
MLサーバが暗号化されたメールをMLメンバーに転送する、MLメンバーは自分の秘密鍵を使って復号しメールを解読する

MLサービスにおけるS/MIMEの利用は、MLサーバ上一時的にメールが復号されるので、セキュリティの懸念点になる可能性がある

