
**IPsec**は、IP(Internet Protocol)を拡張してセキュリティを高めるプロトコルで、改ざんの検知，通信データの暗号化，送信元の認証などの機能をOSI基本参照モデルのネットワーク層レベル(TCP/IPモデルではインターネット層)で提供します。
IPSecを利用する利点は、従来IPを利用していた機器が透過的にIPSecを利用でき、そしてIP通信そのものを暗号化することができるので、機器別に個別設定する手間や、アプリケーション別に暗号化プロトコール設定の手間や漏れのリスクを軽減できる。

### SA Security Association
IPSecのコネクションを始めるには、まず通信相手とSAのネゴシエーションを実施する。
SAはモード、プロトコール、認証方式、暗号化方式、鍵、SPIを記述したパラメータセット、このSAをネゴシエーションはIKEと呼ぶ。
- IKE(Internet Key Exchange)は、通信相手の認証と鍵情報の交換を安全に行うプロトコルです。
IPsecを用いれば上層のアプリケーションに依存せずに暗号化通信を行えるため、VPNの構築に利用されます。  
IPsecはプロトコル群の総称であり、認証、暗号化、鍵交換などの複数のプロトコルを含みます。そのうち、
- 認証を担うプロトコルが**AH**(Authentication Header)、
- 認証と暗号化を担うプロトコルが**ESP**(Encapsulated Security Payload)です。

#### ISAKMP SA
SAネゴシエーション時に、確立した暗号化通信コネクションをISAKMP SAと呼ぶ。
このコネクションは通信相手間のSAパラメータ及び鍵生成パラメータを交換するためなので、双方向で展開される。
これに対して実際のIPSecコネクションは上下分離で、2つのコネクションに分かれる。

通信相手の認証には、次のいずれかの方式が使われる
- 事前共有鍵:予めVPNゲートウェイ同士が共通鍵を交換する
- 公開鍵暗号:通信を行うVPNゲートウェイの公開鍵でIDを暗号化して送信し認証する
- デジタル署名:デジタル証明書を利用して認証DNS

[[AH Authentication Header]]

[[ESP Encapsulating Security Payload]]