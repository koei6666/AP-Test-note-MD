### NATとNAPT
#### NAT（Network Address Translation）

##### 主なポイント
1. **アドレス変換**: NATは、プライベートIPアドレスとパブリックIPアドレスの間でアドレスを変換する技術です。
2. **1対1または1対多のマッピング**: 一つのプライベートIPアドレスは一つのパブリックIPアドレスにマップされる場合もあり、また複数のプライベートIPアドレスが一つのパブリックIPアドレスにマップされる場合もあります。

##### 構成特徴
- **静的NAT**: 事前に設定されたプライベートIPとパブリックIPの対応関係に基づいて変換を行います。
- **動的NAT**: アドレス変換テーブルに基づいて、動的にプライベートIPとパブリックIPがマッピングされます。

##### 用途
- **プライベートネットワークの隠蔽**: 内部ネットワークの構造やアドレスを外部に公開しないで、インターネットにアクセスする。

##### 実世界の例
- **ホームルータ**: 多くの家庭では、複数のデバイスが1つのパブリックIPアドレスを共有してインターネットに接続します。これがNATによって可能になっています。

#### NAPT（Network Address Port Translation）

**NAPT**(Network Address Port Translation)は、プライベートIPアドレスとグローバルIPアドレスを1対1で相互変換するNATの考え方に、ポート番号でのクライアント識別を組み合わせた技術です。ホストごとにユニークなポート番号を割り当てるので1つのグローバルIPアドレスで複数のプライベートIPアドレスを持つノードを同時にインターネット接続させることが可能です。IPマスカレードとも呼ばれます。  
  
パケットを内部から外部に中継する場合は、パケットの発信元プライベートアドレスをルータ(またはファイアウォール)自身のグローバルアドレスに変換するとともに発信元ポート番号に任意のあいているポートを割り当てます。逆に外部から内部に応答パケットを中継する場合は、宛先アドレス＆ポート番号に発信時に保存しておいたプライベートアドレスとポート番号を設定し内部のノードにパケットを通します。

![[ネットワークセキュリティ#^f90dcc]]
![[ネットワークセキュリティ#^85cea8]]
##### 主なポイント
1. **アドレスとポートの変換**: NAPTは、NATと同様にIPアドレスを変換するだけでなく、トランスポート層のポート番号も変換します。
2. **多対一のマッピング**: 複数のプライベートIPアドレス（とポート）が、一つのパブリックIPアドレス（と異なるポート）にマッピングされることが多い。

##### 構成特徴
- NAPTは、同じパブリックIPアドレスを使用しながら、異なる内部デバイスからの接続を区別するためにポート番号を使用します。

##### 用途
- **帯域幅とアドレスの効率的な利用**: 一つのパブリックIPアドレスを多くのユーザーで共有でき、IPアドレスの枯渇問題を緩和します。
- **セキュリティ上の効果**:内部ネットワーク上に存在するホストのアドレスを外部に対して隠蔽できる

##### 実世界の例
- **企業ネットワーク**: 社内の多数のデバイスが、1つまたは数つのパブリックIPアドレスを通して外部と通信する場合、NAPTがよく使用されます。

### NATとNAPTの違い

- **NATはアドレスのみを変換**しますが、**NAPTはアドレスとポート番号の両方を変換**します。
- NATは主に1対1のマッピングを行いますが、NAPTは多対一のマッピングが一般的です。

これらの技術は、プライベートネットワークが安全にかつ効率的にインターネットリソースにアクセスできるように設計されています。特にIPv4アドレスが不足している現在、NATとNAPTは非常に重要な役割を果たしています。

[[Policy based NAT]]
