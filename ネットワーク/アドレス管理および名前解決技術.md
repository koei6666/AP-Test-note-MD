### DHCP
ネットワーク内のノードにIPアドレスを自動的に割り当てるプロトコルをDHCPと呼ぶ。

DHCPサーバは利用できるアドレスを登録しておき、DHCPクライアントが起動するとDHCPサーバにDHCPDISCOVER要求を送信しDHCPサーバーを探索し（DHCPクライアントは事前にDHCPサーバーのIPアドレスを知らない）、IPアドレスを依頼する、そしてDHCPサーバは空いているIPアドレスをクライアントに割り当てをし、利用終了した後IPアドレスの回収まで行う。

DHCPサーバに対するDHCPDISCOVER依頼はクライアントがブロードキャストの形で送信するので、DHCPがブロードキャストに届かない場所（違うLANなど）に存在する場合は、アドレスを取得できないので、DISCOVER依頼をDHCPまで中継するリレーエージェント機能が必要になる。

#### DHCPメッセージ
DHCPサーバとクライアントのやり取りは以下のメッセージとなる
- DHCPクライアントがネット上のDHCPサーバを探すため、DHCPDISCOVER依頼をブロードキャストの形で送信
- DHCPサーバが提供できるIPアドレスなどのネットワーク設定情報をDHCPクライアントに通知するため、DHCPOFFERを送信
- DHCPクライアントはネットワークの設定情報の使用要求をサーバに連絡するため、DHCPREQUESTを送信
- DHCPサーバはネットワークの設定情報の使用要求を認めたことをクライアントに伝えベク、DHCPACKを送信

### DNS
DNS（Domain Name System）は、インターネット上でドメイン名（例：`www.example.com`）とIPアドレス（例：`192.168.1.1`）を相互に変換するシステムです。基本的に、DNSはインターネット上の電話帳のようなものと考えることができます。

#### **主な機能**

1. **名前解決（Name Resolution）**: ユーザーがウェブブラウザにURL（例：`www.google.com`）を入力すると、DNSはこのドメイン名を対応するIPアドレス（例：`172.217.22.14`）に変換します。
2. **逆引き（Reverse Lookup）**: IPアドレスからドメイン名を取得することもできます。
3. **負荷分散（Load Balancing）**: 同一のドメイン名で複数のIPアドレスを管理し、名前の問い合わせが発生するたびに、応答するIPアドレスを順番に変えることで、トラフィックを分散することができます。
![[攻撃手段リスト#^43f4af|DNSのセキュリティ問題]]
![[攻撃手段リスト#^1db6aa|DNSポイズンニング対策DNSSEC]]
### **動作の手順**

1. **ユーザーのリクエスト**: ユーザーがウェブブラウザで`www.example.com`を開くように指示。
2. **ローカルキャッシュのチェック**: コンピュータは最初にローカルキャッシュをチェックして、以前に取得したIPアドレスが残っているかどうかを調べます。
3. **再帰的・反復的クエリ**: ローカルキャッシュに情報がない場合、DNSクエリがローカルDNSサーバーに送信されます。このサーバーは、必要ならば他のDNSサーバーに問い合わせて結果を得ます。
4. **応答**: 最終的にIPアドレスが見つかれば、それがユーザーのコンピュータに返され、ウェブブラウザはそのIPアドレスに接続します。

#### **DNSの種類**

- **TLD（Top-Level Domain）**: 最上位のドメイン。例：`.com`, `.org`, `.jp`
- **SLD（Second-Level Domain）**: TLDの下のレベル。例：`google` in `www.google.com`
- **サブドメイン（Subdomain）**: SLDまたは別のサブドメインの下に位置するドメイン。例：`www` in `www.google.com`

### **DNSのセキュリティ**

- **DNSSEC（Domain Name System Security Extensions）**: DNS情報の改ざんを防ぐためのセキュリティ拡張。

## コンテンツサーバとキャッシュサーバ

DNS（Domain Name System）にはさまざまな種類のサーバーがありますが、その中でも特に重要な役割を果たすのは**コンテンツサーバ（Authoritative Name Server）**と**キャッシュサーバ（Caching or Recursive Name Server）**です。

### **コンテンツサーバ（Authoritative Name Server）**

- **役割**: コンテンツサーバは特定のドメイン（例えば、`example.com`）に関する情報を「権威ある」形で保持しています。このサーバーは、そのドメインに関する質問（クエリ）に対して答える「公式な」情報源です。
- **情報の種類**: 
　- Aレコード（IPv4アドレス）、
　- AAAAレコード（IPv6アドレス）、
　- MXレコード（メールサーバー）
　- NSレコード（DNSサーバを指定）
　- CNAMEレコード（ホストの別名を指定）
- **実世界の例**: Googleのドメイン`google.com`に対する情報は、Googleが管理する権威あるDNSサーバーに格納されています。
- **主な機能**: 名前解決の最終的な答えを提供する。
  
### **キャッシュサーバ（Caching or Recursive Name Server）**

- **役割**: キャッシュサーバは、エンドユーザーからのDNSクエリを受け取り、その回答を見つけ出す責任があります。見つけた回答は一定期間キャッシュ（保存）され、同じ質問がすぐに再度行われた場合には、キャッシュから直接回答を提供できます。
- **動作の手順**: 
  1. キャッシュサーバはまず**ローカルのキャッシュ**を調べる。
  2. キャッシュに情報がない場合、必要に応じて他のDNSサーバー（最終的にはコンテンツサーバ）にクエリを行い、その回答を得る。
  3. 得られた回答をエンドユーザーに返し、一定期間**キャッシュに保存**する。
- **実世界の例**: インターネットサービスプロバイダー（ISP）が顧客にDNS解決サービスを提供する際に使われるDNSサーバがこれに該当します。

### **相互の関係**

キャッシュサーバはエンドユーザーからのクエリに応じて、必要な情報を探す役割があります。そのため、コンテンツサーバにクエリを送ることがよくあります。コンテンツサーバが回答を提供すると、キャッシュサーバはその情報をキャッシュに保存し、エンドユーザーにその情報を返します。

**コンテンツサーバ**が保持する情報は**正確で権威ある**ものであり、**キャッシュサーバ**はその情報を**一時的に保存**して効率を高める役割があります。両者は連携して、インターネットの名前解決システムを高速かつ効率的に機能させています。

#### ダイナミックDNS
**ダイナミックDNS**は、インターネット接続の度に動的に割り振られるIPアドレスとそのホスト名の対応を動的に管理する仕組みです。  
  
常時接続環境ではインターネット接続の度にDHCPからグローバルIPアドレスが割り振られるため、個人が自宅サーバを公開するときにホスト名とIPアドレスの対応をとることができないという問題が生じます。ダイナミックDNSでは、この問題に対応するために接続がある度(IPアドレスが割り振られる度)にIPアドレス・ホスト名対応情報の登録・更新をDNSサーバへ行います。これによって固定IPアドレスがない環境でも常に同じホスト名でアクセスさせることができるようになります。