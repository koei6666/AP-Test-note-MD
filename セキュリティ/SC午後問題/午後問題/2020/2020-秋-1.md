# 1.
![[Pasted image 20250311233226.png]]
![[Pasted image 20250311233448.png]]
![[Pasted image 20250311233833.png]]
決済処理の流れは、~~バーコードで表示している会員番号に対して決済するので、他人の会員番号を表示するバーコードを入手した場合それを表示すれば、~~他人の会員番号を入手し、バーコードで表示すれば、他人になりすまして決済することができる。
決済アプリの問題は、バーコードが会員番号の固定値であること

# 2.
![[Pasted image 20250311234641.png]]
![[Pasted image 20250311234706.png]]
HMACaとHMACbと一致するかどうかを検証する
QRコード生成時では、会員番号と乱数と時刻をもとにHMACを計算しているので、検証時の時刻で同じアルゴリズムでHMACを計算し、最初生成したHMACaと照合すれば、会員番号と時刻と乱数を照合でき、QRコードのリプレイをまず防ぐことができ、その上乱数が入ったことで、他人によるQRコードの生成でも防止することができる。

# 3.
![[Pasted image 20250312212836.png]]
![[Pasted image 20250312212927.png]]
項番2~4の指摘：
![[Pasted image 20250312213006.png]]
LANルータの設定
![[Pasted image 20250312213116.png]]
項番2~4への対策に書いてあるように、指摘2、4を解決しないと、利用者が攻撃者の用意したサーバに接続しても気づかないという問題があるので、~~ということは逆に考えると、元々の正しい設定では、ルータから接続可能なサーバは制限されているということが推測できる、そしてそれと関連する項目を探してみると　えのパケットフィルタリングはこの問題を解決できるとわかる。
変更後の設定内容に関しては、攻撃者のサーバへのアクセスを許可~~
この問題に関して重要なポイントは、攻撃者の用意したサーバに接続しても**気づかない**という点、攻撃者のサーバに接続できてしまうという点だけで考えると、確かにえのパケットフィルタリングと若干関係あるように見えるが、攻撃者がパケットフィルタリングの設定を変更した場合では、パケットフィルタリングルールと、ネットのログからすぐアクセス先がバレるし、
そして一番重要な矛盾点は、仮に攻撃者が自分をサーバを追加したとしても、他の措置と組み合わせてユーザに自分のサーバをアクセスしてもらわないと、攻撃が成り立たない。
以上の2ポイントから考えると、いのDNSサーバを攻撃者のDNSサーバに変更すると、問い合わせに対して偽な回答を返せば気づかれない上、ユーザがアクセスするようなサイトのIPアドレス回答を悪意のあるサイトに変更すれば、攻撃が成り立つので、正解はい、攻撃者のDNSサーバIPアドレスを設定

# 4.
![[Pasted image 20250312215311.png]]
![[Pasted image 20250312215336.png]]
![[X.509 Certificate Structure#Subject Alternative Name]]
現在一般的に使用されているX.509証明書機構では、その証明書の有効ドメインを複数個格納できる**subjectAltName**がある、検証時では優先的にそれを検証する。
検証時では、SAN内に格納されるDNS(ドメインを示すidentifier)とその証明書所在する**FQDN**と比較する。
subjectAltNameが存在しない場合では、X.509を利用していないレガシイシステムだと考えられるので、その証明書の**subject**にある**CommonName**をFQDNと比較する
![[PKI#**コモンネーム**(CN Common Name)]]

# 5.
![[Pasted image 20250312223618.png]]![[Pasted image 20250312223634.png]]
項番5:
![[Pasted image 20250312223700.png]]
会員登録機能：
![[Pasted image 20250312223741.png]]
メールアドレスが会員登録されているかどうかによって表示が変わる挙動

# 6.
![[Pasted image 20250312224032.png]]
![[Pasted image 20250312224123.png]]
2-b
メールアドレスが使用済みと表示されないようにする
2-aと同じようなメッセージを表示する