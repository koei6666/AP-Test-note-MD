# 1.
![[Pasted image 20250106211815.png]]
![[Pasted image 20250106212014.png]]
問題文から確認すると、重要情報が記録されているCSVファイルを何物が閲覧できるような状態では、表1の要件を満たさなくなったと読み取り、次に該当のCSVファイルについて確認をする
![[Pasted image 20250106212151.png]]
CSVファイルをキーとして探すと、batchappuserが出力する、注文テーブルというものがあるとわかる。
そして注文テーブルの内容を見ると、表1に規定した重要項目に該当する項目が記載されているので、問題文の重要情報が記載されているCSVファイルはこのファイルのこととわかる。
![[Pasted image 20250106213733.png]]
そして、権限を確認すると、ファイル所在の`/var/data`もファイル自体も、770,660とオーナーとグループに`read`と`write`の権限が付与されている。
[[Access Permission]]

batchappuserは各プログラムがデータ連携用に使用しているので、問題はないが、グループにも読み取り権限が付与されているので、同じグループにその権限を与えるべきではないユーザーがいるかどうかを確認する。
![[Pasted image 20250106213707.png]]
同じくoperationグループを確認すると、システム運用担当者が利用するoperatorもoperationグループに所属しているので、上記の注文テーブルを確認でき、表1を満たさないことが分かった。
![[Pasted image 20250106212303.png]]

# 2.
![[Pasted image 20250106221352.png]]
本問は前問の続きで、問題のbatchappuserをどのグループに移せば、表1の要件を満たせる問題。
前問確認した通り、batchappuserの問題は重要情報扱っているのに、同グループ内では重要情報を扱えない他のユーザーがいることになるので、
その問題を、batchappuserを重要情報扱えるグループに移動すれば解決なので、重要情報を扱えるグループを探していく
![[Pasted image 20250106221650.png]]
ユーザーの各役割の中、唯一重要情報を参照すると記載されているのは、重要情報取扱運用者なので、そのユーザーのグループであれば、権限の問題は発生しないので、そのユーザーのグループを確認していく
![[Pasted image 20250106221535.png]]
表２から、重要情報取扱運用者は`personal`グループを使用していることがわかるので、これと回答する前に、batchappuserのグループ変更によって、その動きに障害発生しないかを、念のためアクセス権限を確認する。
![[Pasted image 20250106212303.png]]
下記から、本番環境アクセス可とわかるので、答えはpersonalとなる
![[Pasted image 20250106222439.png]]

# 3.
![[Pasted image 20250106222549.png]]
![[Pasted image 20250106222611.png]]
プログラム3に暗号化処理を追加した後、どのプログラムに複合処理を追加するを問う問題、
表を見ると、同じく注文データのCSVを扱うのは3,4番だけ、復号は勿論データベースを更新する前の4番
![[Pasted image 20250106222638.png]]
![[Pasted image 20250106222723.png]]

# 4.
![[Pasted image 20250106223038.png]]
![[Pasted image 20250106223114.png]]
問題文の中の25,26行目から見ていく、25、26行はデータベースに対してデータをコミット動きを記載している、問題文ではパスワードが平文として保存されるとのことなので、パスワードはこの2ステップ内で作成されていないので、パスワードの作成工程に問題あるとわかる
![[Pasted image 20250106223525.png]]
パスワードの作成、暗号化工程では、`SHA-1`を取得した後パスワードを暗号化する動きなので、万が一ユーザーのコンピュータでは、SHA-1がインストールされていない場合では、例外が発生する、ただこのコードでは例外をキャッチした後適切な処置をしてなくそのまま次に流しているので、答えは5行目に例外が発生する場合にパスワードが平文として保存される。
![[Pasted image 20250106223355.png]]
パスワードを暗号化した後、class UserDataのpasswordパラメーターに保存される、ここで平文で保存されれば、addUserメソッドを使うとき`this.password`から値を引き出して登録する際には平文でデータベースに登録される。
サンプルコードの中のUserDataはクラスを立ち上げる
```java
public UserData(HttpServletRequest request) {
	this.userId = request.getParameter("userId")
	...
}
```
# 5.
![[Pasted image 20250106225152.png]]
運用担当者とシステム開発者がアクセスしてはならない情報は、前問あった通り、ユーザの個人情報を含めた重要情報とわかるので、それに該当するデータを探すとadduserメソッドはこれらの情報を扱っていると確認できる。
![[Pasted image 20250106225904.png]]
そしてこれらの情報はどうやって漏洩するかを確認すると、コード内では、SQLのエラーをログに出力する記述があると確認できる
![[Pasted image 20250106230240.png]]
ここから、ユーザーの重要情報が埋め込まれたSQLがデバッグログと、ろぐサーバのAPログに出力されていることがわかる、
![[Pasted image 20250106230435.png]]
そしてそれぞれユーザの権限を確認すると運用担当者は本番APサーバにアクセスでき、`/var/log/severlog`の権限も775となっているので、その他のユーザ（運用担当者が）アクセスし、読み取りできるようになっている。
（本来の問題文では、権限が774となり、オーナーには4(read),2(write),1(execute),グループにも同じ、その他は4(read)しか付与されなく、webappuserとそのグループpersonalしかこのディレクトリにアクセスできないので、問題に質問された運用担当者operatorとそのグループoperationからはアクセスできないので、問題としては成立しない、訂正された問題では、その他へ付与した権限は5、4(read),1(execute)なので、ディレクトリへのアクセスは全員可能、これで問題が成立し、中のファイルがoperatorにアクセスされてしまうという問題が発生する)
問題の中では、デバッグログはどこにあるかは明記していないが、コメントされたデバッグログの下の2行は`System.out.println`より出力されているので、標準出力先を見てみると`/var/log/serverlog`にあるとわかる。
本文
開発担当者は、ログサーバに転送されるログファイルを確認できるので、本問の答えは

運用担当者:パスワード、氏名、郵便番号、住所、電話番号、メールアドレス
出力される場所: エ

開発担当者
出力される場所：オ
![[Pasted image 20250106230731.png]]

# 6.
![[Pasted image 20250106232106.png]]
![[Pasted image 20250106232140.png]]
![[Pasted image 20250106232158.png]]
![[Pasted image 20250106232227.png]]
SHA-256

# 7.
![[Pasted image 20250106232319.png]]
前問のコードと同じにならないように、ここはアルゴリズムが見つからない場合は処理を中断するようにRuntime errorをthrowする
コード
```java
throw new RuntimeException(e)
```
![[Pasted image 20250106232352.png]]

# 8.
![[Pasted image 20250106232652.png]]
![[Pasted image 20250106232725.png]]
tryとcatchの後なので、ここはfinallyと記入する

# 9.
![[Pasted image 20250106232818.png]]
![[Pasted image 20250106232852.png]]
![[Pasted image 20250106232915.png]]
ア