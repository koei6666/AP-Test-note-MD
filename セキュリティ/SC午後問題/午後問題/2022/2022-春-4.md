# 1.
![[Pasted image 20250205231118.png]]
![[Pasted image 20250205231255.png]]
![[Pasted image 20250205231444.png]]
アの場合では、`<meta property="og:url" content="https://www.b-sha.co.jp/confirm?"><img src= 1 onerror=alert(1)><"">`
三つのタグが全てクローズされているので、正しい

イの場合では、`<meta property="og:url" content="http://www.b-sha.co.jp/confirm?><img src= 1 onerror=alert(1)><"">`
metaタグではクローズされていなく、imgと最後の<"">がクローズされていなく、正しく解釈されない

# 2.
![[Pasted image 20250205235311.png]]
![[Pasted image 20250205235340.png]]
![[Pasted image 20250205235354.png]]
![[Pasted image 20250205235653.png]]
他のユーザのcsrftokenを使ってログインができるということなので、ユーザのアイデンティティと紐付けしていることがわかる。
なので、ユーザIDかJSESSIONIDと紐付けしている

# 3.
![[Pasted image 20250206212940.png]]
![[Pasted image 20250206213132.png]]
まず2行目から、サイトXの画面という記述があり、説明文にサイトXのクリックジャッキングの脆弱性がありとのことなので、fは画面αとわかる、次にcは手前に表示させ、ユーザのクリックをハイジャックする攻撃なので,cは画面ßになるとわかる。

次に、dはß画面に関する記述で、a画面のクリックをハイジャックするには、表に表示させクリックさせないといけないので、a画面を手前に表示する、ただユーザが画面の内容を見るとクリックしなくなりますので、その前面に表示しているa画面を透明な状態で表示する。
次に、ユーザを混乱させるß画面は裏に表示させるが、その内容をユーザに見せないといけないので、可視な状態で表示する
d:ア.奥
e:ア.可視の
g:イ.手前
h:イ.透明な

# 4.
![[Pasted image 20250206215851.png]]
上記2件の対策として、CSPとX-Frame-Optionsが有効とわかる。
そして問題文の中では後者は標準化されているとのことなので、ブラウザに標準化されているのはCSPで、答えはエ.X-Frame-Optionsとイ.Content-Security-Policy
![[Content Security Policy]]
![[攻撃手段リスト#X-Frame-Options]]

# 5.
![[Pasted image 20250209102729.png]]
![[Pasted image 20250209102759.png]]
![[Pasted image 20250209102817.png]]
![[Pasted image 20250209103144.png]]
~~クエリストリングの値をメンテナンス用WEBインターフェイスのURL~~
topicの値をhttps://db-y-sha.co.jp/に変更

# 6.
![[Pasted image 20250209103450.png]]
![[Pasted image 20250209103514.png]]
![[Pasted image 20250209103653.png]]
入力した時の流れのステップ２では、GET METHODが失敗した場合のreturnURLが記載されている、通常時ではwebサイトの用意したエラー画面が表示される仕組みとなっているが、このURLを悪意のサイトに変更された場合エラーが発生するとその悪意アドレスにアクセスしてしまう。
なので、テストする際では、'V氏が用意したサイトのFQDN'が正解になる。

# 7.
![[Pasted image 20250209111347.png]]
![[Pasted image 20250209111408.png]]
~~問題は、DBのWEB管理インターフェイスがアクセスされることなので、その問題を解決するにはreturnURLを検証するほかに、そもそもWEB管理インターフェースを外部のIPアドレスからアクセスを禁止すべきなので、答えはweb管理インターフェースへのアクセスを社内IPアドレスからのアクセスに限定するとなる~~！web管理インターフェースへのアクセス制限を設けることが正しくない理由は、質問では**B社で**実施することが望ましい対策と書かれているので、インターフェースへのアクセス制限はB社で実施するものではないので、適切ではない。
P社宿泊サイトからのレスポンスに含まれるアドレスが改竄されることが問題になるので、それが改竄されないようにするには、returnURLを固定値にすることが考えられる。
具体的には、例えばレスポンスが戻ってきてそれを処理するプロセスの中、エラーが発生した場合に表示するページは動的にレスポンスに含まれるものではなく、サーバ側に保存された固定値のアドレスにアクセスすることが対策の一つと考えられる。

# 8.
![[Pasted image 20250209125600.png]]
![[Pasted image 20250209125620.png]]
上記の会話は、A社のWebセキュリティ管理基準をB社に導入することを検討するに纏わる内容なので、まずはA社のWebセキュリティ管理基準に関してを確認する
![[Pasted image 20250209130119.png]]
A社のWebセキュリティ管理基準の中に特に注意してみるのが、問題文の中のソースコードレビューとツールによる脆弱性診断の項目
![[Pasted image 20250209131105.png]]
![[Pasted image 20250209131147.png]]
![[Pasted image 20250209131239.png]]
該当の3項目では、揃って'セッション管理の脆弱性は一部だけが対象と認可・アクセス制御の脆弱性は対象外'と書かれているので、
回答は対象外の内容を回答するので、'一部のセッション管理の脆弱性と認可・アクセス制御の脆弱性'となる。

# 9.
![[Pasted image 20250209131923.png]]
![[Pasted image 20250209131940.png]]
![[Pasted image 20250209132008.png]]
![[Pasted image 20250209132032.png]]
改良リリースサイクル中の休止期間中に実施する

# 10.
![[Pasted image 20250209132319.png]]
![[Pasted image 20250209131940.png]]
改良サイクル中に診断のための期間を設け、~~数回のリリースに1回の診断を設ける~~定期的に長い改良リリースを設ける
別解：
専門技術者による脆弱性診断が必要な場合、改良リリースを次回に持ち越す
半年に一度、改良リリースの期間を長くする

# 11.
![[Pasted image 20250209133018.png]]
![[Pasted image 20250209133041.png]]
![[Pasted image 20250205235354.png]]
![[Pasted image 20250209134552.png]]
フレームワークでCSRFのどういう問題を解決すればいいという質問、
まずは、フレームワーク導入するのであれば、CSRFトークンの発行自体をライブラリーが行うことになる。
次に、問題文の中に実際問われた対策されていない点は、フレームワークで対策しないといけないので、CSRFトークンの紐付け、そして検証することもライブラリーで対応する。
次に、csrfトークンがリクエストの中に含まれているから削除されたりすることが発生するので、それを解消するには、csrfトークンのhtml埋め込みが必要になるので、html埋め込みもその対象になる