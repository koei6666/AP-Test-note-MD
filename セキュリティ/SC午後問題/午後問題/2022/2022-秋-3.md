# 1.
![[Pasted image 20250126141834.png]]
![[Pasted image 20250126141909.png]]
![[Pasted image 20250126141927.png]]
![[Pasted image 20250126141948.png]]
表3から、runプロセスのPIDが200と確認、そして表4にPID200に該当するコネクションを確認し、宛先が`a3.b3.c3.d3`と確認できる

# 2.
![[Pasted image 20250126142127.png]]
![[Pasted image 20250126142146.png]]
![[Pasted image 20250126142245.png]]
![[Pasted image 20250126141927.png]]
コネクションコマンドrunの親プロセスIDは、Tソフトのjava SBMainとは同一のため、Tソフトを調査すべきとわかる

# 3.
![[Pasted image 20250126144222.png]]
![[Pasted image 20250126144241.png]]
b:
脆弱性を利用してアクセスしてきたログの中に一番時間が早いのは、
![[Pasted image 20250126144833.png]]

c:
![[Pasted image 20250126144917.png]]
![[Pasted image 20250126144952.png]]
13:05:50
a8.b8.c8.d8
LDAP
~~Exploit~~JExp
![[URL#他のスキームのQuery]]

[[Log4Shell CVE-2021-44228]]

>この攻撃は、log4jの、ログ内の任意コードを実行できてしまう脆弱性を利用して実施される。
>流れとしては、攻撃者がリクエストのユーザーエージェント内に悪意のあるコードを埋め込み：
>![[Pasted image 20250413112338.png]]
>log4jがこのアクセスを受けた後、ユーザーエージェントに埋められたjndiリクエストを使って、攻撃者サーバにldap依頼を送信する、
>攻撃者サーバからこの依頼に対して悪意のスクリプトを返信する。
# 4.
![[Pasted image 20250126170612.png]]
![[Pasted image 20250126170826.png]]
![[Pasted image 20250126205846.png]]
![[Log4Shell CVE-2021-44228#仕組み]]
~~理由は攻撃文字列をログ内に表示するだけで実行される、~~ログの出力処理に攻撃文字列が含まれていれば悪用される可能性があるため
攻撃者が攻撃コードを含めたリクエストを送れば、サーバのログに残り、脆弱性によってそれを表示するだけで、ldapによって悪意のあるコードがダウンロードされる

# 5.
![[Pasted image 20250126210217.png]]
![[Pasted image 20250126210242.png]]
![[Pasted image 20250126210451.png]]
![[Pasted image 20250126210514.png]]
~~会員サーバへのアクセスはhttps限定のため~~会員サーバーからインターネットへのLDAP通信が許可されていないから
予約サーバではfw上、インターネットへの全てのサービスを許可しているので、アクセスログを表示した場合中に含まれるldapのリクエストを出してfwを通せるのだが、会員サーバはhttpsの受信しか許可されていなく、ldapの送信は許可されていないので、アクセスログを表示しても通信は成立しない

# 6.
![[Pasted image 20250126211024.png]]
![[Pasted image 20250126211038.png]]
![[Pasted image 20250126211424.png]]
g=予約サーバ
h=SNS投稿用サーバ
i=すべて
