---
tags:
  - OSコマンドインジェクション
  - DNSキャッシュポイズンニング
---
# 1.
![[Pasted image 20250122204551.png]]
![[Pasted image 20250122204629.png]]
DNSキャッシュサーバが権威DNSサーバに名前解決を行なった時に、偽装したDNS応答を送信するという記述になるので、DNSキャッシュポイズニング

![[攻撃手段リスト#DNSキャッシュポイズンニングとの違い]]

# 2.
![[Pasted image 20250122214354.png]]
![[Pasted image 20250122214417.png]]
エ
![[DNS#^0ea5e6]]
[[Why DNS uses UDP]]

# 3.
![[Pasted image 20250122214820.png]]
![[Pasted image 20250122214843.png]]
1.権威DNSサーバより先に攻撃者の回答がキャッシュサーバに到着する

# 4.
![[Pasted image 20250122215040.png]]
![[Pasted image 20250122215108.png]]
サーバ証明書により、アクセス先のサーバの真正性を検証する実装

# 5.
![[Pasted image 20250122215233.png]]
![[Pasted image 20250122215314.png]]
ファームウェア実体が置き換えられる懸念に対する対策になるので、そのコードが改竄されているかどうかを検証すれば防止できるので、コードサイニングを導入する

# 6.
![[Pasted image 20250122215510.png]]
![[Pasted image 20250122215743.png]]

図2のIPアドレスなどの枠に、コマンドをインジェクトすれば、そのままの文字がシェルに渡されるので、dは任意のコマンドを実行できて（しまう）
模範回答：シェルが実行するコマンドをパラメータで不正に指定できて

> #Tricky 
> ユーザーから入力の任意コマンドを実行できてしまうの誤答：脆弱性自体はユーザから、外部から入力された任意コマンドを実行できることだが、ここの質問はsetvalueの処理にどのような問題があるということなので、リクエストを見ればわかるように、setvalue実態はコマンドの実行はしなく、ユーザから入力されたパラメーターの値をifconfigに渡して設定している。
> ここでは任意コードの実行ではなく、シェルが実行するコマンドのパラメーターを不正に実行できるが模範回答になる。
> 試験時では、主語をマークして、その主語をもとに解答を考える。

# 7.
![[Pasted image 20250122220240.png]]
![[Pasted image 20250122220339.png]]
![[Pasted image 20250122220359.png]]
==攻撃リクエスト==~~悪意のあるスクリプト~~をPOSTメソッドで送信させるを~~罠サイトに埋め込み~~==スクリプトを含むページを==、表示させる仕組み

> #Tricky 悪用すると悪用したをはっきり見分ける
> 悪意のあるスクリプトをダウンロードするスクリプトを埋め込みと誤答、原因は、`脆弱性Bを悪用する攻撃リクエストを送信`を`脆弱性を悪用した攻撃リクエスト`を送信と見落とし、前者では脆弱性Bは攻撃リクエストを限定しているだけ、答えの中には脆弱性Bを答える必要がないが、後者になると、攻撃リクエストは脆弱性Bが存在してから初めて利用できるという意味になってしまうので、修飾語を正しく理解する必要がある。

> #Tricky XSS攻撃は表示するだけで発動する
> もう一点は、XSS攻撃への理解不足、攻撃スクリプトは表示されただけで実行される

# 8.
![[Pasted image 20250122221317.png]]
![[Pasted image 20250122221346.png]]
トークンなので、推測困難性

# 9.
![[Pasted image 20250122221442.png]]
脆弱性A：
ア.OSコマンドインジェクション

脆弱性B:
オ.クロスサイトリクエストフォージェリ