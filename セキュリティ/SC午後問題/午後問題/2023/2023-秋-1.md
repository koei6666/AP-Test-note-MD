# 1.
![[Pasted image 20250107213839.png]]
![[Pasted image 20250107214411.png]]
![[Pasted image 20250107214435.png]]
![[Stored XSS|格納型XSS]]
ページ内では、データベースに保存されたコメントを表示する際に、その中に埋め込まれたスクリプトがトリガーされる。
データベースに格納されているスクリプトなので、格納型XSSが回答になる。

# 2.
![[Pasted image 20250107215313.png]]
![[Pasted image 20250107214435.png]]
問題のコードから分かるように、XSSスクリプトがトリガーされるのは、ユーザーの入力した内容が適切にエスケープされていないことが分かる。
なので、XSS対策は、ユーザー入力した内容を表示する前に適切にエスケープする

# 3.
![[Pasted image 20250107220223.png]]
![[Pasted image 20250107214435.png]]
htmlに埋め込まれたコード見ると分かるように、長いスクリプトを分割し入力、`/*　*/`でhtmlをコメントアウトすることで長いスクリプトを連結する。

# 4.
![[Pasted image 20250107222304.png]]
![[Pasted image 20250107222402.png]]
![[Pasted image 20250107225039.png]]
