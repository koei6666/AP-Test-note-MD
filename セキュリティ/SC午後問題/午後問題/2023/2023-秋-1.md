---
tags:
  - セキュアプログラミング
  - XSS
---

# 1.
![[Pasted image 20250107213839.png]]
![[Pasted image 20250107214411.png]]
![[Pasted image 20250107214435.png]]
![[Stored XSS|格納型XSS]]
ページ内では、データベースに保存されたコメントを表示する際に、その中に埋め込まれたスクリプトがトリガーされる。
データベースに格納されているスクリプトなので、格納型XSSが回答になる。

# 2.
![[Pasted image 20250107215313.png]]
![[Pasted image 20250107214435.png]]
問題のコードから分かるように、XSSスクリプトがトリガーされるのは、ユーザーの入力した内容が適切にエスケープされていないことが分かる。
なので、XSS対策は、ユーザー入力した内容を表示する前に適切にエスケープする

# 3.
![[Pasted image 20250107220223.png]]
![[Pasted image 20250107214435.png]]
htmlに埋め込まれたコード見ると分かるように、長いスクリプトを分割し入力、`/*　*/`でhtmlをコメントアウトすることで長いスクリプトを連結する。

# 4.
![[Pasted image 20250107222304.png]]
![[Pasted image 20250107222402.png]]
![[Pasted image 20250107225039.png]]
機能説明の6からわかるように、ユーザーがアイコンをアップロードするときはまず、`user/upload`にアクセスして、トークンを取得しないといけなく、そしてサンプルのコードを確認すると、ユーザはXSSが設置されたページにアクセスすると、XSSコードはまずユーザのprofileページにアクセスとトライ、成功した後、（質問中の6~20行）トークンを取得し,トークンと一緒にユーザーのcookieをアイコンファイルとしてサイトにアップロードする。
![[Pasted image 20250111151035.png]]
模範回答では、セッションIDをアイコン画像ファイルとしてアップロードというのは、仕様紹介文の中では、セッションIDをcookieとして払い出すという記述があったから。

# 5.
![[Pasted image 20250111151255.png]]
前問では、ユーザーのセッションIDをアイコン画像としてアップロードするxssコードの動きが説明された、本問では、そのアップロードされたアイコン画像からセッションIDを取り出す手法が問われる。
セッションIDを画像ファイルとしてアイコンに設定しているので、そのアイコンファイルをダウンロードすれば、セッションIDを取り出せる。

# 6.
![[Pasted image 20250111151908.png]]
![[Pasted image 20250111152132.png]]
セッションIDを取得すると、会員のログイン済みの状態を入手できるということなので、機能の内、ログイン済み会員だけが利用できる機能が全て利用できるようになる。

>この問題の回答では、間違って会員ログインした後できることを回答してしまう可能性があり、問題を考えるときは、設問に聞かれたことを正しく理解する必要がある。
>例えばこの問題では、取得した情報（セッションID）を使ってできることは何かと聞かれている、会員ログインした後利用できるアプリQの機能を利用できるようになるのは確かだが、それは取得したセッションIDを使った後の間接的な結果であり、直接な結果ではない。
>セッションIDを取得したことによって一番直接にできるようになるのは、会員に成り済ますこと。
>これを回答した上、アプリQの機能を利用すると組み合わせて文にすれば模範回答になる

まとめて書くと、ログイン会員になりすまして、アプリQの機能を使用する

# 7.
![[Pasted image 20250111153951.png]]
[[SOP Same Origin Policy]]
スクリプトから異なるドメインのURLにcookieを送れない仕組み

私が苦手な問題タイプは： R5春-午後I-1:Java preparedStatementに関する問題　原因：Javaの開発経験がない R5春-午後I-2:FTP接続のPASVモードに関する問題　原因：FTPの経験が薄く、接続モードの動きがわかりにくい 攻撃手順を具体的に説明を求める問題　原因：得点ポイントはどこになるのかわからず、どこに重点を置いて書けばいいのかわからない これらをもとに、問題選択をテクニックを分析してください