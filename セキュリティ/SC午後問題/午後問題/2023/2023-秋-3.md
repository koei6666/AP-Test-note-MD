---
tags:
  - TLS
  - Linux
  - WebAuthn
---

# 1.
![[Pasted image 20250113215059.png]]
![[Pasted image 20250113215155.png]]
コンテナのよる仮想化の脆弱性を悪用しなくても成功できる攻撃を選択とのことで、まずコンテナによる仮想化の脆弱性というのは、何らかの方法でコンテナ上のアプリにアクセスしているユーザが、アプリの環境から脱出し、コンテナのホストOSにアクセス出来るようになる。
[[コンテナエスケープ]]
![[Pasted image 20250113215619.png]]
選択項目を1つずつ見て、それぞれ間違った理由は：
　ア. CIデーモンはサーバのバックエンドに存在しているので、コンテナエスケープでホストOSに到着しなければそれにアクセスことはできないので、不正解。
　イ.バックエンドのプロセスに関わる行動なので、同じくコンテナ中からではわからない
　ウ.不正アクセスの試みは必ずしもコンテナ外から行う必要はないので、正解
　エ.上記と同じ理由で、コンテナの中からでも、命令取得できれば、それをコンテナの中で実行することができる。
　オ.他のNサービス利用者の痕跡が見えるのは、コンテナの中では不可能、コンテナエスケープした後に全仮想環境に向けて見ることはできる。

# 2.
![[Pasted image 20250113222410.png]]
ユーザが攻撃者の用意した偽サイトのリンクを踏んだ後、攻撃者が偽のログイン画面を表示し、ユーザのIDとパスワードを騙し取り、それを使ってログインを試みる、そして偽のTOTP入力画面を表示し、送信されたワンタイムパスワードを騙し取り、それを使ってログインする。

模範回答：偽サイトでワンタイムパスワードを騙し取り、有効期間内にそれを使ってログインする

# 3.
![[Pasted image 20250113223407.png]]
![[Pasted image 20250113223435.png]]
証明書発行ログはキーワードになる、証明書のログを確認することで認証局の信頼性と、コンプライアンスを確認するのはCertificate Transparency
![[Certificate Transparency]]

# 4.
![[Pasted image 20250113224438.png]]
![[Pasted image 20250113224714.png]]
脅威のないドメインを偽装として、TLSのホストを攻撃者のサーバに指定する手口なので、ドメインフロンティング攻撃
![[ドメインフロティング攻撃]]

# 5.
![[Pasted image 20250113230928.png]]
![[Pasted image 20250113231816.png]]
![[Pasted image 20250113231835.png]]
![[Pasted image 20250113231850.png]]
Linuxの環境変数に保存されているシークレットをどうやって盗み出すに関するの質問、環境変数の内容を確認するコマンドは`/proc`だが、それに導く証拠は以下になる：
まずシークレット機能に関して、説明文の中では、APIキーなどを利用者が登録し、ビルドスクリプトと分けて保管する機能とわかる、そしてそのシークレットを使うのはコマンド実行機能である。
次の説明を見ていくと、コマンド実行機能はバックエンドのCIデーモンが提供するとのことなので、コード実行に必要なシークレットも同じ環境に保管されると推測される。
バックエンドはLinuxので、その環境変数をチェックする`/proc`が正解になる。
![[Proc]]

# 6.
![[Pasted image 20250113233440.png]]
![[Pasted image 20250113233543.png]]
認証に用いる情報に含んだオリジンおよび署名をサーバが確認する仕組み
![[WebAuthn]] 

# 7.
![[Pasted image 20250113234204.png]]
![[Pasted image 20250113234233.png]]
![[DNS Records#^ec373f]]
![[PKI#^065014]]

# 8.
![[Pasted image 20250113234453.png]]
![[Pasted image 20250113234544.png]]
![[Pasted image 20250113234511.png]]
コードサイニング用証明書が漏洩されたため、攻撃者が悪意のコードを含んだ偽造のアプリを署名し、APIキーを使ってJストアにアップロードされる可能性がある

# 9.
![[Pasted image 20250113234836.png]]
![[Pasted image 20250113234907.png]]
![[Pasted image 20250113235015.png]]
漏洩した恐れのあるAPIキーをJ社WEBサイトから削除する

# 10.
![[Pasted image 20250113235125.png]]
![[Pasted image 20250113235231.png]]
PCから取り出せないので、秘密鍵が漏洩しない

# 11.
![[Pasted image 20250113235343.png]]
![[Pasted image 20250113235401.png]]
![[Pasted image 20250113235515.png]]
影響：署名鍵を変更したため、アプリは起動しなくなる
対応：アプリをアップデートする