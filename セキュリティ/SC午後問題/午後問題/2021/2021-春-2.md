# 1.
![[Pasted image 20250301093814.png]]
![[Pasted image 20250301093834.png]]
![[Pasted image 20250301093900.png]]
外部DNSサーバはA社の権威DNSサーバなので、それがサービス停止になった場合では、==A社の公開Webサーバの名前解決ができなくなる==

# 2.
![[Pasted image 20250301094148.png]]
![[Pasted image 20250301094205.png]]
送信元を偽装して、DNS回答を偽装された送信元に反射(リフレクション)する攻撃なので、==DNSリフレクション攻撃==

# 3.
![[Pasted image 20250301094416.png]]
![[Pasted image 20250301094438.png]]
変更:
![[Pasted image 20250301094502.png]]
変更内容は権威DNSサーバをDNS-Kに、フルサービスリゾルバをDNS-Fに、
権威DNSサーバは再帰問い合わせに対応し、自分のドメインに対して回答するサーバなので、インターネットからの問い合わせを受け付けないといけないためインターネットからのアクセスを許可する必要がある。
一方、フルサービスリゾルバはLANからの問い合わせをインターネット上のDNSサーバに問い合わせエージェントの役割なので、インターネットへのアクセスを与えるべき。
![[Pasted image 20250301094857.png]]
FWはステートフルパケットインスペクション型という注記があるので、トラフィックのスタートポイントだけルールに追加すれば両方向の通信が通るので、a= ==DNS-F==, b= ==DNS-K==

# 4.
![[Pasted image 20250301095059.png]]
![[Pasted image 20250301095117.png]]
フルサービスリゾルバが管理しているメールサーバのレコードといえば、MXタイプと思い浮かぶが、この問題のポイントは、攻撃者が**IPアドレス**を書き換えると記載しているところ。
MXレコードは下記の通り、URLで記載しているので、このURLを書き換えると容易に内容が違うことが気づかれる、そして問題の記述した内容とも一致しない。
```DNS Record
example.com.    3600    IN    MX    10    mail.example.com.
```
MXレコードを使う際に、DNSサーバにもう一度そのURLを名前解決するプロセスが発生する、名前解決した結果得るのは下記のAレコード
```DNS Record
mail.example.com.    3600    IN    A    192.0.2.10
```
AコードのIPアドレスを変更した場合では、気づかれにくいというポイントと、問題文の記述と一致するので、この問題の正解は==A==

# 5.
![[Pasted image 20250301100558.png]]
![[Pasted image 20250301100634.png]]
![[Pasted image 20250301100648.png]]
対策する問題：
![[Pasted image 20250301095117.png]]
DNSキャッシュポイズニング攻撃への対策として、送信元ポート番号の処理を問う問題。
まず、DNSキャッシュポイズンニング攻撃は、攻撃者がDNSサーバに問い合わせして、正規な回答が来る前に先に偽の情報を回答に偽装してDNSサーバに回答し、DNSサーバの持っているキャッシュを汚染する攻撃である。
それを防止するために、送信元ポート番号を推測できないようにすれば、攻撃者がどのポートに対して回答すればいいのか把握できなくなるから、ポイズンニングされる可能性が低くなる。
送信元ポート番号を推測できないようにする手法としては==ランダム化==

# 6.
![[Pasted image 20250301101245.png]]
![[Pasted image 20250301101311.png]]
DNSレコードをディジタル署名する技術なので、[[DNS#^1dac9e|DNSSEC]]

# 7.
![[Pasted image 20250301101459.png]]
![[Pasted image 20250301101519.png]]
改竄される可能性があるのは、問い合わせ元から、問い合わせ先の間なので、fは問い合わせ元である==フルサービスリゾルバ==、gは~~~~権威DNSサーバ~~[[スタブリゾルバ]]。
権威DNSサーバではない理由は、フルサービスリゾルバへのDOT通信はフルサービスリゾルバの暗号鍵と、スタブリゾルバへ配布する公開鍵だけで成り立つが、世の中の全ての権威サーバとDOTするには、これら全てのサーバの公開鍵を管理する必要があり、現実的ではないのと、権威サーバの全てもDOTに対応しているとは限らない。
その上、権威サーバの配布している情報は公開情報なので、盗聴というリスクはなく、その上改竄のリスクに対して、一部のサーバではDNSSECを導入しているので、DOTでは権威サーバとの間の通信では対応しない。

# 8.
![[Pasted image 20250301101714.png]]
![[Pasted image 20250301101742.png]]
~~障害発生時、名前解決不能になるリスク~~は最終的な事象になるが、その事象を引き起こす根本的な原因は、権威DNSサーバがサービス停止になること、プライマリとセカンダリ二つ権威DNSサーバを導入するのは、そのうち一つの権威DNSサーバがサービス停止になっても、もう一つが継続的にサービスできる目的なので、低減できるリスクとしては: ==権威DNSサーバがサービス停止になるリスク==

# 9.
![[Pasted image 20250301104613.png]]
![[Pasted image 20250301104631.png]]
![[Pasted image 20250301104650.png]]
ゾーンファイルは一つのドメインに関連する名前を記録したファイルで、図の中を見ると、すでにNSにDNS-Kが入っている、
DNS-Kはプライマリ権威サーバなので、次にセカンダリ権威サーバをもう一つのNS枠に記録するので、hはXサービスでホスティングしているDNS-Sになるので、h= ==dns-s.x-sha.co.jp==
次に、MXのメールサーバレコードでは、x-shaとa-shaの二つの選択肢が与えられていますが、図の下を見ると,mailはa-shaのゾーンファイルに入っているので、A社は自分のドメイン上にメールサーバをホストしていることがわかる、なのでi= ==mail,a-sha.co.jp.==

# 10.
![[Pasted image 20250301105602.png]]
![[Pasted image 20250301105620.png]]
![[Pasted image 20250301105632.png]]
まず、プライマリとセカンダリの間以外のゾーン転送は基本的には禁止なので、lとmは拒否。
そしてjに関しては、プライマリがセカンダリにゾーン転送要求しないので拒否、
セカンダリがプライマリに対してゾーン転送要求することがあるので、kは許可
![[DNSサーバ#ゾーン転送の方向]]

# 11.
![[Pasted image 20250301111237.png]]
![[Pasted image 20250301111255.png]]
![[Pasted image 20250301111307.png]]
案：
![[Pasted image 20250301111340.png]]
まずフィルタリングルールを見ると、2件ともDNSサービスなので、それぞれLAN->WAN, WAN->LANと推測できる。
ただ、内容を見ると、プライマリとセカンダリーはXサービス上にホストされるので、WANからの通信がなくなるので、残ったのはLANからの問い合わせのみ、そしてネットワーク構成を見ていく
![[Pasted image 20250301112150.png]]
![[Pasted image 20250301112411.png]]
機器の概要では、社外への通信はプロキシサーバを経由しているので、フルサービスサーバが社外に移されたので当然その通信もプロキシサーバを通すことになる、n= ==オ==, o= ==ア==
次に、同じく社内ネットワークから名前解決する必要があるのは、メールサーバが挙げられる、p= ==カ==
