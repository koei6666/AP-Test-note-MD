# 1.
![[Pasted image 20250222114427.png]]
![[Pasted image 20250222114453.png]]
![[Pasted image 20250222114651.png]]
XSSが組立され表示されて初めて効果するので、URL1入力した後のHTTPレスポンスでは元々alertを表示する内容となっているが、報告中では内容は適切にエスケープされていることから、`<`と`>`のエスケープされた文字列であることがわかる
`&lt;` `&gt;`
![[HTML entity encoding]]

# 2.
![[Pasted image 20250222115726.png]]
![[Pasted image 20250222115749.png]]
![[Pasted image 20250222115852.png]]
![[Pasted image 20250222115826.png]]
図7のレスポンスにXSS脆弱性が確認されたとのことなので、URL2のrefURLを入力した後、レスポンスにスクリプトを組立できる、
次に参考URLを組み立ててみると：
イ：`<a href = ""><script>alert('XSS!')</script>"><script>alert('XSS!')</script></a>`
エ：`<a href = "javascript:alert('XSS!')">javascript:alert('XSS!')</a>`
イはhtmlフォーマットに不備があり（`<a>`が途中で`">`によりブレークされ、a tagが完了されていないため実行されない）
エは正しく組立されているので、実行される

# 3.
![[Pasted image 20250222122307.png]]
![[Pasted image 20250222122331.png]]
![[Pasted image 20250222115826.png]]
![[Pasted image 20250222122409.png]]
![[Pasted image 20250222122433.png]]
図３で特定されたXSS脆弱性を解消するために改修方法が問われる質問、特定された脆弱性はrefURLを出力時にXSS脆弱性があるということで、原因を確認したところ、図9の結果が示したように、XSSを防ぐ処理は一部されているが(`"`が`&quot;`にか着替えされている)、HTMLタグの属性値は~~エスケープされていないことが分かった、回答はHTMLタグの属性値にある特殊符号はHTMLとして解釈されないようにエスケープする~~適切な処理されていないことがわかる。
適切な処理は何かというと、前問の実際テストしたXSS脆弱性では、urlを表示するためのタグだが、`javascript:`のスキームも出力できてしまうことから、脆弱性が発生しているので、その脆弱性に対して、出力されるのは`http:`と`https:`スキームの内容のみと限定すれば回避できるので、回答は`http:`　`https:`のURLだけを出力する

# 4.
![[Pasted image 20250222123915.png]]
![[Pasted image 20250222123939.png]]
CSPは表示できる各種のコンテンツとスクリプトのオリジンを制限することができる、問題の中の`script-src 'self'`は、該当ページに実行できるスクリプトは、そのページのURLと同じオリジンからのスクリプトファイルに限定すると指定している。

# 5.
![[Pasted image 20250222132452.png]]
![[Pasted image 20250222132526.png]]
まず、Dシステムが使用するスクリプトに関する記述があるかどうかを確認する、
確認したところ、特定のスクリプトに関する記述がないので、この問題は一般的なスクリプトに対する質問だとわかる、
そして、前提条件は、CSP script-srcをselfに設定した後実行が制限されてしまうスクリプトあるかどうかなので、まずCSP設定した後発生する制限を羅列する:
1.異なるオリジンのスクリプトファイルからのスクリプト
2.HTMLに存在するinlineスクリプト
1では、Dシステムの正規なスクリプトでは考えられないケースなので、該当しないと考え、2について、DシステムがHTML内にスクリプトを埋め込んだ場合、CSPの設定によって実行されなくなる可能性があるので該当する。
==DシステムのHTML内に含まれるスクリプト==

次にそれを変更後の呼び出し方法に関して、CSPの要求に準じて、URLと同じオリジンにあるスクリプトファイルに、スクリプトを移動して、そのスクリプトファイルから呼び出す

# 6.
![[Pasted image 20250222133854.png]]
![[Pasted image 20250222133918.png]]
[[ISO 27017]]
[[ISO 27018]]

ISO27017はクラウドサービスにおける、情報セキュリティ管理策の規範で、ISMS(ISO27001)を起訴にされる規範である。
ISO27018は、クラウドサービスにおける、個人情報保護に関する管理策である。

# 7.
![[Pasted image 20250224120232.png]]
![[Pasted image 20250224120259.png]]
他国の要請によって強制的にデータ提出しなければいけない場合、その**ファイルの内容**を保護する方法を検討する、他国に強制提出されてしまった場合では、平文で保存されるデータがそのまま渡されると、漏洩してしまうので、対策としては暗号化することが考えられる、そして簡単に解読などされないように、暗号化方法はU社の秘密鍵を使った公開鍵方式の暗号化

# 8.
![[Pasted image 20250224120950.png]]
![[Pasted image 20250224121019.png]]
利用者IDを固定してパスワードを総当たりする手法に対する検知手段に関して、一定時間あたり、==同一利用者IDの==ログイン失敗の回数が閾値を超えたら検知するが挙げられる

# 9.
![[Pasted image 20250224121342.png]]
![[Pasted image 20250224121420.png]]
![[Pasted image 20250224121437.png]]
不正アクセスの方法に関しての検出方法は、攻撃者がゆっくりトライすれば、検出されなくなるのは一つの場合で、一定のパスワードに対して利用者IDの総当たりをする(パスワードスプレー)の検知方法の中に、同一IPアドレスからの異なる利用者IDによるログインが閾値を超えると検知されるので、この唯一の定数を変えると検出されなくなるので、この場合では、ログイントライするIPアドレスを変えながらログイントライすると、見逃される可能性がある。

# 10.
![[Pasted image 20250224122054.png]]
![[Pasted image 20250224122118.png]]
![[Pasted image 20250224122132.png]]
![[Pasted image 20250224122423.png]]
攻撃者が、Webブラウザと認証サーバの間に、不正のサーバを設置し、ユーザから認証情報を騙し取る可能性があるので、ブラウザから認証器に送信する際に現在アクセス中のサイトのオリジンを一緒に送付すれば、認証器で、ブラウザがアクセスしているサイトが正規なサイトかどうかを検証することができる。
攻撃者が==メッセージをKサービスとの間で中継==するために、攻撃サーバを設置する。

# 11.
![[Pasted image 20250225215017.png]]
![[Pasted image 20250225215102.png]]
まず、認証器としてスマートフォンの、不正利用対策としての利用時の手順について探す
問題の背景は、KサービスというIDaaSを利用した場合、FIDOの認証器になるものが紛失または盗難にあった場合の対処方法が問われる。
特に注意が必要なのは、どのようなFIDO認証器が使われても、認証されるのはKサービスのアカウント、そして認証器の仕組み表に書かれた下記項目を読めばわかるように、FIDO認証器とKサービスのアカウントは一対一で紐付けされている。
![[Pasted image 20250225220825.png]]
以上からわかるように、もしFIDO認証器が盗難や紛失などに遭い、それからのアクセスを封じたい場合、また、利用者が退職し、使っていた認証器からアクセスさせないようにするには、それとリンクしているアカウントを無効化/削除する方法がある
![[Pasted image 20250225215209.png]]
使用時に、h= ==生体認証==が必要になることがわかる
退職時または退職後に、不正アクセスに関する措置を探す
認証情報と認証プロセスを管理しているのは、IDaaSのKサービスなので、利用者が退職などの場合は、==Kサービス==から、==アカウントを削除==

![[Pasted image 20250225220314.png]]
認証器が紛失で、見つかった場合ではそのまま使うこともできるので、なのでこの問では前問みたいにアカウント削除ではなく、紛失している間にアカウントを停止すれば、第三者によるアクセス防止には十分な効果がある。

# 12.
![[Pasted image 20250225221834.png]]
![[Pasted image 20250225221854.png]]
Dシステムのセキュリティ要件：
![[Pasted image 20250225222752.png]]
[[セキュリティ要件]]内の、アクセスポリシーに関する内容になるので、文の中では明確にセキュリティ要件という言葉は出ていないが、内容的にはセキュリティ要件に該当する。
そして、スマートフォンとOS内蔵の違いをこの上に比較してみると、スマートフォンでは、認証すれば、任意の端末からDシステムにアクセス可能だが、OS内蔵では、その端末からしかアクセスできないように自然と制限をかけることができる。
