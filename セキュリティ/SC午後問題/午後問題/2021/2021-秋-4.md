# 1.
![[Pasted image 20250222114427.png]]
![[Pasted image 20250222114453.png]]
![[Pasted image 20250222114651.png]]
XSSが組立され表示されて初めて効果するので、URL1入力した後のHTTPレスポンスでは元々alertを表示する内容となっているが、報告中では内容は適切にエスケープされていることから、`<`と`>`のエスケープされた文字列であることがわかる
`&lt;` `&gt;`
![[HTML entity encoding]]

# 2.
![[Pasted image 20250222115726.png]]
![[Pasted image 20250222115749.png]]
![[Pasted image 20250222115852.png]]
![[Pasted image 20250222115826.png]]
図7のレスポンスにXSS脆弱性が確認されたとのことなので、URL2のrefURLを入力した後、レスポンスにスクリプトを組立できる、
次に参考URLを組み立ててみると：
イ：`<a href = ""><script>alert('XSS!')</script>"><script>alert('XSS!')</script></a>`
エ：`<a href = "javascript:alert('XSS!')">javascript:alert('XSS!')</a>`
イはhtmlフォーマットに不備があり（`<a>`が途中で`">`によりブレークされ、a tagが完了されていないため実行されない）
エは正しく組立されているので、実行される

# 3.
![[Pasted image 20250222122307.png]]
![[Pasted image 20250222122331.png]]
![[Pasted image 20250222115826.png]]
![[Pasted image 20250222122409.png]]
![[Pasted image 20250222122433.png]]
図３で特定されたXSS脆弱性を解消するために改修方法が問われる質問、特定された脆弱性はrefURLを出力時にXSS脆弱性があるということで、原因を確認したところ、図9の結果が示したように、XSSを防ぐ処理は一部されているが(`"`が`&quot;`にか着替えされている)、HTMLタグの属性値は~~エスケープされていないことが分かった、回答はHTMLタグの属性値にある特殊符号はHTMLとして解釈されないようにエスケープする~~適切な処理されていないことがわかる。
適切な処理は何かというと、前問の実際テストしたXSS脆弱性では、urlを表示するためのタグだが、`javascript:`のスキームも出力できてしまうことから、脆弱性が発生しているので、その脆弱性に対して、出力されるのは`http:`と`https:`スキームの内容のみと限定すれば回避できるので、回答は`http:`　`https:`のURLだけを出力する

# 4.
![[Pasted image 20250222123915.png]]
![[Pasted image 20250222123939.png]]
CSPは表示できる各種のコンテンツとスクリプトのオリジンを制限することができる、問題の中の`script-src 'self'`は、該当ページに実行できるスクリプトは、そのページのURLと同じオリジンからのスクリプトファイルに限定すると指定している。

# 5.
![[Pasted image 20250222132452.png]]
![[Pasted image 20250222132526.png]]
まず、Dシステムが使用するスクリプトに関する記述があるかどうかを確認する、
確認したところ、特定のスクリプトに関する記述がないので、この問題は一般的なスクリプトに対する質問だとわかる、
そして、前提条件は、CSP script-srcをselfに設定した後実行が制限されてしまうスクリプトあるかどうかなので、まずCSP設定した後発生する制限を羅列する:
1.異なるオリジンのスクリプトファイルからのスクリプト
2.HTMLに存在するinlineスクリプト
1では、Dシステムの正規なスクリプトでは考えられないケースなので、該当しないと考え、2について、DシステムがHTML内にスクリプトを埋め込んだ場合、CSPの設定によって実行されなくなる可能性があるので該当する。
==DシステムのHTML内に含まれるスクリプト==

次にそれを変更後の呼び出し方法に関して、CSPの要求に準じて、URLと同じオリジンにあるスクリプトファイルに、スクリプトを移動して、そのスクリプトファイルから呼び出す

# 6.
![[Pasted image 20250222133854.png]]
![[Pasted image 20250222133918.png]]
[[ISO 27017]]
[[ISO 27018]]
