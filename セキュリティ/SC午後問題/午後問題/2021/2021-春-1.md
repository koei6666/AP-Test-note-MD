# 1.
![[Pasted image 20250227202038.png]]
![[Pasted image 20250227202056.png]]
S社課題：
![[Pasted image 20250227202151.png]]

Tサービス：
![[Pasted image 20250227202218.png]]

S社課題は、多要素認証の実装、そしてTサービスは多要素認証の機能を持っているので、Tサービスの多要素認証機能を利用して利用者認証できるようになるので、==Tサービスの多要素認証機能を利用することで、自社で開発しなくて良くなった==

# 2.
![[Pasted image 20250227202650.png]]
![[Pasted image 20250227202756.png]]
認証モジュールを完全社外のサービスに委託すると、可用性の観点からでは、社外のサービスが障害など発生した場合に、自社のサービスも影響を受けてログインできなくなることが挙げられるが、改修の詳細内容を見ると、~~ID連携は新規登録の会員だけが対象になるので、回答にはその細かい制限も記載して~~　**特に可用性の観点から述べないといけないのと、改修した後のS認証モジュール継続稼働の状況は当面なので、適用された全体の状況を述べる**：==Tサービスが障害した場合、==~~改修後新規登録のS会員が認証できなくなる~~==Sサービスが利用できなくなる==

# 3.
![[Pasted image 20250227215508.png]]
![[Pasted image 20250227215703.png]]
![[Pasted image 20250227215832.png]]
問題文では、bが提供するリソースにアクセスできるとのことなので、図ではリソースにアクセス権限を与えるアクセストークンを発行するのがTサービスなので、b= ==Tサービス==
そして,aはTサービスの提供するリソースにアクセスするので、図から見れば==Sサービス==になる
最後に、cは、リソースにアクセスする権限を与える役割になるので、OAuthの仕組みと、図から見ると==利用者==になるとわかる

# 4.
![[Pasted image 20250227220623.png]]
![[Pasted image 20250227215703.png]]
![[Pasted image 20250227215832.png]]
OAuthは、利用者がサービスに所有するリソースに対する権限を、直接利用者に確認する仕組みになるので、シーケンスの中では、利用者からTサービスに直接権限を確認するステップ==え==になる

# 5.
![[Pasted image 20250227221346.png]]
![[Pasted image 20250227221422.png]]
![[Pasted image 20250227221455.png]]
攻撃者がユーザーとサービスSの間に中継して、利用者のリソースへのアクセス許可を取ろうとする攻撃なので、dは攻撃者が認可コードを受領した後ユーザーに転送するステップなので==ウ==,eは攻撃者の中継かどうかとは関係なく、通常通りのアクセストークンを要求するステップになるので==ア==

# 6.
![[Pasted image 20250227222209.png]]
![[Pasted image 20250227221455.png]]
攻撃シーケンスから見ればわかるように、攻撃サイトを踏んでしまった場合のシーケンスでは、ユーザがTサービスに認証を受けるステップがないので、攻撃の流れとしては、ユーザに攻撃者のアカウントのアクセス権限を与え、ユーザがアカウントをちゃんと確認せずにファイルをアップロードしてしまうと、攻撃者が自分のアカウントからそのままダウンロードすることができるので、アップロードもダウンロードも攻撃者のアカウント

# 7.
![[Pasted image 20250227222711.png]]
![[Pasted image 20250227222732.png]]
![[Pasted image 20250227215832.png]]
OAuthのStateの目的は、認証を開始したセッションは、認可コード受領後アクセスしてきたセッションは同一セッションかどうかを確認すること、
そのためにstateパラメータは認証開始後、Sサービスが利用者をリダイレクトするメッセージに含む必要がある（い）
認証完了後、利用者が戻ってきた時、その利用者は認証開始した時と同じ利用者かどうか（同じセッションかどうか）を確認する必要があるので、次のステップは(か)

# 8.
![[Pasted image 20250227223931.png]]
![[Pasted image 20250227223949.png]]
要求する権限：
![[Pasted image 20250227224037.png]]

提供する権限：
![[Pasted image 20250227224104.png]]

必要な権限：
![[Pasted image 20250227202218.png]]

必要な権限から見ると、TサービスはID連携のために利用されているだけなので、提供する権限のうち、TサービスのSNS機能は不要と考えられる、なので最低に必要な権限は(エ)

# 9.
![[Pasted image 20250227224458.png]]
![[Pasted image 20250227224517.png]]
![[Pasted image 20250227202756.png]]
改修後新規登録したS会員では、SモジュールにIDとパスワードを登録してなく、Tサービスとの連携IDだけでログインなどをしているので、==Sモジュールに、IDとパスワードを登録してないS会員==は利用できなくなる

# 10.
![[Pasted image 20250227225305.png]]
![[Pasted image 20250227225333.png]]
![[Pasted image 20250227225810.png]]
SサービスへのTサービスのアカウント連携の流れは：
1. Sサービス会員登録者のログイン中のTサービスアカウントからT-IDを取得する（Tサービスにログインしていない場合はログインが促されるとのことなので、アカウント持ってない登録者はこのステップでアカウント作成することになると推測される）
2. T-IDをSサービスに登録する

連携、登録の流れから見ると、T-IDを識別のキーとしてユーザを認証しているので、利用者認証する方法をまとめると、==T-IDがSサービス上登録されているかどうかを確認する==