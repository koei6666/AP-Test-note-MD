## Windows BitLocker

Microsoft Windows環境で最も一般的な実装例はBitLockerです：

- TPMと連携したPIN認証をサポート
- 起動時にPINの入力を要求し、正しいPINが入力されたときのみTPMがディスク暗号化キーを解放
- 企業環境ではグループポリシーにより強制的に設定可能

## macOS FileVault + T2チップ

Apple MacのFileVault暗号化：

- 新しいモデルではT2セキュリティチップ（TPMと同様の機能を持つ）と連携
- ログインパスワードに加えて、追加の起動PINを設定可能
- AppleのSecure EnclaveとFileVaultが連携することで同様の保護を実現

## Linux LUKS + TPM

Linux環境では：

- LUKS（Linux Unified Key Setup）暗号化とTPMを組み合わせた実装
- systemd-bootとTPMを連携させてPIN保護を実現
- TPM2.0デバイスと連携して暗号化キーをセキュアに管理

## 企業向けセキュリティソリューション

- Symantec Endpoint Encryption
- McAfee Complete Data Protection
- Dellのデータセキュリティソリューション

これらのソリューションでは、TPMチップと連携したPINベースの認証を採用し、物理的なデバイス盗難時にもデータを保護するための多層防御アプローチを実装しています。

このような実装は特に企業や政府機関など、高度なセキュリティ要件を持つ組織で広く採用されています。一般的なビジネスノートPCの多くにTPMが搭載されており、これらの保護機能を活用できるようになっています。

## BitLocker + TPM + PIN の認証フロー

### 1. システム起動時（プリブートフェーズ）

1. コンピュータの電源を入れる
2. UEFI/BIOSが起動し、ブートシーケンスが開始される
3. BitLockerのプリブート環境が読み込まれる
4. **最初のPIN入力画面が表示される**
    - この時点ではまだWindowsは起動していない
    - 青い画面に数字入力フィールドが表示される
5. ユーザーがPINを入力
6. TPMがPINを検証
    - 正しいPIN: TPMがディスク暗号化キーを解放
    - 誤ったPIN: 再入力を要求（一定回数の失敗でロックアウト）

### 2. オペレーティングシステム起動

1. PINが正しく検証されると、BitLockerは暗号化キーを使ってシステムドライブを復号化
2. Windowsの起動プロセスが開始される
3. Windows起動画面が表示される

### 3. Windowsログイン

1. 通常のWindowsログイン画面が表示される
2. ユーザーが**Windows用のパスワード/PIN/指紋**などを入力
    - これはBitLockerのPINとは別の認証
3. Windows認証が完了し、デスクトップが表示される

## 重要なポイント

- **二段階の認証**: 最初にBitLockの暗号化解除用のPIN、次にWindowsログイン用の認証情報
- **異なる目的**: 最初のPINはディスク暗号化キーの解放が目的、二番目の認証はWindowsアカウントへのアクセス許可が目的
- **異なるセキュリティレイヤー**: プリブート環境とWindowsオペレーティングシステム
- **異なる管理システム**: BitLockerはシステム保護、Windowsアカウントはユーザー権限管理

このような二段階のセキュリティにより、物理的な盗難・紛失リスクと不正ログインのリスクの両方に対する保護が実現されます。PCが盗まれても、BitLockerのPINがわからなければディスクコンテンツの復号化ができず、さらにWindowsのパスワードがわからなければログインできないという多層防御となっています。