The TLS handshake is a fundamental process that establishes a secure connection between a client and a server using the Transport Layer Security (TLS) protocol. This process involves several steps to ensure both parties authenticate each other, agree on encryption methods, and generate session keys for secure communication.

## Steps of the TLS Handshake
![[Pasted image 20240923142219.png]]

1. **Client Hello**: The handshake begins with the client sending a "Client Hello" message to the server. This message includes:
   - Supported TLS versions (e.g., TLS 1.2, TLS 1.3)
   - A list of supported cipher suites (encryption algorithms)
   - A random number generated by the client, which will be used later in key generation.

2. **Server Hello**: The server responds with a "Server Hello" message that contains:
   - The chosen TLS version from the client's list
   - The selected cipher suite
   - A server-generated random number
   - The server's digital certificate, which includes its public key.

3. **Authentication**: The client verifies the server's digital certificate against trusted Certificate Authorities (CAs) to ensure it is communicating with the legitimate server.

4. **Key Exchange**: 
   - The client generates a "premaster secret," which is a random number used to derive session keys.
   - This premaster secret is encrypted with the server's public key and sent to the server.

5. **Session Key Generation**: Both the client and server use the premaster secret along with their previously exchanged random numbers to generate session keys for symmetric encryption.

6. **Finished Messages**: 
   - The client sends a "Finished" message encrypted with the session key, indicating that its part of the handshake is complete.
   - The server responds with its own "Finished" message, also encrypted, confirming that it is ready to proceed.

7. **Secure Communication Established**: After these messages are exchanged, a secure session is established, allowing encrypted data transmission between the client and server using symmetric encryption.

## Key Features

- **Asymmetric and Symmetric Encryption**: The handshake uses asymmetric encryption (public/private key pairs) for securely exchanging keys and symmetric encryption for fast data transmission during the session.
- **Cipher Suites**: These define the algorithms used for key exchange, encryption, and hashing during the session.
- **Session Keys**: Unique keys generated for each session ensure that even if one session is compromised, others remain secure.

## Differences in TLS Versions

- **TLS 1.2 vs. TLS 1.3**: TLS 1.3 streamlines the handshake process, reducing it to one round trip (1-RTT) compared to two round trips (2-RTT) required by TLS 1.2. This improvement enhances performance while maintaining security standards.

The TLS handshake is crucial for securing online communications by ensuring that data remains confidential and unaltered during transmission, thereby protecting users from potential threats such as eavesdropping or man-in-the-middle attacks.
