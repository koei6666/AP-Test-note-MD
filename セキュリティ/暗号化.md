システム運用には「盗聴」、「改ざん」、「なりすまし」、「否認」などのリスクがある。
盗聴リスクに対する代表的な措置は暗号化。

### 暗号化に必要な要素

基本要素：
- 平文を暗号化できるルールがあること
- 暗号を平文に戻せる（復号する）ルールがあること
これら二つのルールは同じでも構わない、そのルールに代入する情報をキーと呼ぶ。
例えば、換字式という手法では、文字の順番をずらすことで暗号化する（Aを3つずらしてDになる、あるいは「あ」をみつずらして「え」になる）、そのずらす数はこのルールのキーとなる。


暗号化に対して、以下の手段で暗号の解読が試みられる：
- 暗号を複合できるキーを入手する
- 暗号の復号手順を推定し、キーがなくても暗号から平文を得ようとする。

以上の解読手段に対して、暗号化に必要な要素は以下になる：
- キーを不正に入手できないように厳重に管理する
- 変換ルールを複雑にして、容易に推測できないようにする
他に、以下の要素も：
- 攻撃手法に合わせて、新しい暗号化ルールを取り入れること
- 解読にかかるコストを、解読対象の価値に見合わないぐらいに増大させること

### 暗号化方式の種類

##### 共通鍵暗号方式
- 暗号化のルール（キー）と復号のルール（キー）が同一になる
- 送信者と受信者が同じキーを持つ
- 送信相手が増えるごとに管理するキーの数が増え、キー管理の負担が増大する
  n人が相互通信する場合は$\frac{n(n-1)}{2}$個の鍵が必要になる
  **共通鍵暗号方式**では、送信者と受信者で共有している同じ鍵を使用するので、通信の組合せの数だけ異なる鍵が必要になります。  
　相互に通信を行う人数が2人の場合は1個、3人の場合は3個、4人の場合は6個、5人の場合は10個というように増えていきます。
　![[Pasted image 20230924012245.png]]
　
- 共通鍵の配布手法が手間になる

注意すべき点：
　- 共通鍵を外部に漏らさないこと
　- 共通鍵を作成した時双方に送付する方法を工夫すること

##### 共通鍵暗号の実装方式
　- ブロック暗号
　  平文を一定長のブロックに分割し、それぞれ暗号化する方式
　  **代表的な方式：**
　  DES：$2^{56}$の鍵パターンがある、平文を8バイトのブロックに分割し、キーによる変換処理を16回繰り返す。
　  AES：AES(Advanced Encryption Standard)は、アメリカ合衆国の次世代暗号方式として規格化された _共通鍵_ 暗号方式です。旧国家暗号規格のDES(Data Encryption Standard)では鍵長が56ビットであったのに対して、AESでは鍵長が最大256ビットとなり暗号強度が高められています。
　  Triple DES
　  FEAL
　  IDEA
　- ストリーム暗号
　  平文を1ビットごとに暗号する手法
　  **代表的な方式：**
　  RC4,KCipher-2など

##### 公開鍵暗号方式
- ==暗号化鍵（公開鍵）==は広く一般公開し、誰でも暗号化できる
- ==復号鍵（秘密鍵）==は、受信者のみが管理するので、受信者だけが復号できる
- 受信者は送信者が増えても、秘密鍵を一つで全部解読できるので、鍵管理の負担が少ない
  n人が相互通信する場合は$2n$個の鍵が必要になる
  （n人が相互に暗号を使って通信する場合、秘密鍵を保持する受信者はn人ですので必要となる秘密鍵はn個です。さらにこれらの秘密鍵に対応する公開鍵がn個必要になるため、鍵の総数は「n＋n＝2n個」となります。）
- 共通鍵方式に比べて、暗号化、復号処理に時間がかかる

##### 公開鍵暗号の実装方式
**公開鍵暗号方式**は、受信者の公開鍵と秘密鍵の鍵ペアを使用して暗号化／復号を行う暗号化方式です。送信者は、==受信者の公開鍵==を使って暗号化したデータを送信し、==受信者は自分の秘密鍵==を使ってデータを復号します。


**代表的な方式：**
RSA:大きな数値の素因数分解に膨大な時間がかかることを安全な根拠とする暗号化方式
鍵長が2048ビット以下だと、現代のコンピューターの計算能力だと解読されるリスクがある ^1f9ca8

その他には、離散対数問題の困難性を安全の根拠とした楕円曲線暗号やElGamal暗号がある。
楕円曲線暗号は鍵長が短くても安全性を確保できるので、TLSにも利用される


### ハイブリッド方式
公開鍵の演算は非常に複雑で、大きなデータを処理する際は膨大な時間がかかるので、ハイブリット方式が考案された。
ハイブリッド方式はデータの本体を共通鍵方式で暗号化し、共通鍵を公開鍵方式で暗号化してから配布する、この技術をエンベロープ暗号化という。

ハイブリッド方式は [[アプリケーション層のプロトコル#^36f445|S/MIME]],PGP,SSL/TLSといった暗号化技術に使われる。

[[セキュリティ/ストレッチング]]

