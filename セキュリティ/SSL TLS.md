SSL:Secure Socket Layer
TLS:Transport Layer Security

### TLSでの通信
TLSでの通信は、ハンドシェイクとデータの伝送の2部分に分けることができる。

#### ハンドシェイク
サーバを認証し、暗号化鍵を作るためのステップ、これによってTLS通信路を構築し、その通信路を使って暗号化通信を行う。

TLSハンドシェイクの目的：
- サーバを認証する
- 利用する暗号アルゴリズムとプロトコルのバージョンを決める
- 秘密鍵を作成し、共有する。

#### データの転送（暗号化送信）
TLSのデータ送信は、MAC(Message Authentication Code)を送信データに追加し、送信データとMACを一緒に暗号化し、受信先に送付する。
MACは送信データから計算するコードで、データが異なれば、MACも異なるという性質を持っているので、MACを付加することで、改竄防止と盗聴対策になる。

#### MAC Message Authentication Code
通信内容の改ざん有無を確認するために通信データから生成される固定長のビット列。
MACの生成には、共通鍵暗号(HMAC:Hash-function based MAC)方式とブロック暗号(CMAC: Cipher based MAC)方式の二通りがある。

### サーバ認証とクライアント認証
TLSでは、サーバ認証は必須に対して、クライアント認証はオプションである。
クライアント認証を実施する際の、クライアントとサーバの間のメッセージのやり取りとしては以下の手順となります。

...クライアントがサーバに接続リクエストをする...
1. サーバは、クライアントにサーバ証明書を送付するときに、クライアント証明書の提示を要請する
2. クライアントは、サーバにクライアント証明書を送付する
3. サーバは、クライアント証明書を検証して、クライアントを認証する
![[Pasted image 20230924013207.png]]

CAによって発行されるサーバ証明書では、認証の厳しさに応じてDV証明書＜OV証明書＜EV証明書がある。
- DV証明書：ドメイン認証型証明書、ドメインの真正性、利用権が確認できれば、発行できる証明書。オンライン発行と短時間審査がメリットが、ドメインと申請する企業の一致性は確認されない
- OV証明書：企業認証型証明書、DVのドメイン真正性と利用権に加えて、申請する組織が法的に存在するかどうかを信用調査機関や電話で確認してからの発行になる
- EV証明書：EV SSL証明書　最も厳格な証明書、CAブラウザフォームのEVガイドラインを認証基準として使われている。

### SSLトンネリング
SSLではクライントの==Webブラウザ==と通信相手の==Webサーバ間==の通信を暗号化するので、間にプロキシサーバが存在しても内容が漏えいすることはありません。  
クライアント(Webサーバ)からSSLの接続要求を受け取ったプロキシは、通信の内容には介入せずデータをコピーしてWebサーバ(クライアント)に送信します。この動作を_SSLトンネリング_と呼びます。

