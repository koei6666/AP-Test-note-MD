---
CVSS Score: "3.4"
Vulnerability Type: cryptographic vulnerability
---
Padding Oracle On Downgraded Legacy Encryption
## 概要
SSL3.0のPadding Blockに対する脆弱性を利用して、クライアントに埋められた攻撃コードがサーバとのTLS HandshakeでSSL3.0使用を強制させることで、クライアントの発信した暗号化のパケットを解読する。

## 仕組み
クライアントに仕込まれる攻撃コード（ブラウザからスクリプトを運行させる権限を持つ必要がある）が、サーバと通信する際に、わざとTLS Handshakeを失敗させること（Handshake中止させる、パケットを破損させ、破棄する、またはClientHelloメッセージのTLSバージョンを改ざんや、サポートする暗号スイートリストを改竄するなどの方法）で、サーバに、TLSをサポートしないクライアントと誤認させ、FALLBACKを強制させる。
脆弱性のあるSSL3.0にFALLBACKした後、攻撃者はSSL3.0のPadding Blockに対する脆弱性を利用して、クライアントのパケットを解読する。

## 対策
- SSL3.0の利用を禁止/TLSのみ使用許可
- TLS_FALLBACK_SCSVを適用:　現代のブラウザほとんど適用されている（無効化にすることも可能）、TLS_FALLBACK_SCSVをサーバに送信することで、万が一サーバがFALLBACKした場合には、”クライアントが高いバージョンの暗号スイートをサポートしている”ことをサーバに知らせる。
  サーバがFALLBACKした暗号スイートのバージョンとクライアントのサポートしているバージョンと比較し、クライアントの方がバージョン新しければ、怪しいFALLBACKと検知し、その旨を送信し、接続を中止する。