---
CVSS Score: "3.1"
Vulnerability Type: Authentication Bypass
---

SNMP v1とv2cにおける、コミュニティ名を利用し、ネットワークの構成情報探索、ネットワークの設定変更、DDoSなどを実施できる脆弱性がある。

### SNMP コミュニティ名脆弱性による脅威
- 情報収集：
    - ネットワーク構成、デバイス情報、トラフィック統計などの詳細な情報を取得できます。
    - この情報は、さらなる攻撃の計画に利用される可能性があります。
- ネットワークマッピング：
    - ネットワークトポロジーやデバイスの種類を特定し、攻撃対象を絞り込むことができます。
- 設定変更：
    - 読み書き権限がある場合、デバイスの設定を変更し、セキュリティを弱体化させる可能性があります。
- DoS攻撃：
    - SNMPリクエストを大量に送信し、デバイスやネットワークのリソースを枯渇させる攻撃が可能です。
- 中間者攻撃：
    - SNMPトラフィックを傍受し、偽の情報を送信したり、正規の情報を改ざんしたりする可能性があります。
- パスワード推測：
    - publicコミュニティ名が使用されている環境では、他の簡単なコミュニティ名も使用されている可能性が高くなります。
- ファームウェアバージョンの特定：
    - 脆弱性のあるファームウェアバージョンを特定し、それを標的にした攻撃を行う可能性があります。
- 不正アクセスポイントの設置：
    - ネットワーク機器の情報を取得し、類似した不正なアクセスポイントを設置して通信を傍受する可能性があります。

### Publicコミュニティ名攻撃の仕組み

1. SNMPの基本動作：
   SNMPは通常UDP上で動作し、主にポート161（クエリ）と162（トラップ）を使用します。SNMPv1とv2cでは、コミュニティ名がプレーンテキストで送信されます。

2. スキャンと検出：
   攻撃者は、ネットワークスキャンツール（例：nmap）を使用して、SNMPが有効なデバイスを特定します。
   ```
   nmap -sU -p 161 192.168.1.0/24
   ```

3. コミュニティ名の推測：
   「public」や他の一般的なコミュニティ名を使用して、SNMPクエリを送信します。
   ```
   snmpwalk -v2c -c public 192.168.1.100
   ```

4. 情報収集：
   成功した場合、MIB（Management Information Base）からデータを取得します。例えば：
   - システム情報： .1.3.6.1.2.1.1 (system)
   - インターフェース情報： .1.3.6.1.2.1.2 (interfaces)
   - ルーティングテーブル： .1.3.6.1.2.1.4.21 (ipRouteTable)

5. 権限の確認：
   読み取り専用か読み書き可能かを確認します。読み書き可能な場合、設定変更が可能です。
   ```
   snmpset -v2c -c public 192.168.1.100 [OID] s "new value"
   ```

6. 自動化ツールの使用：
   攻撃者は、これらのプロセスを自動化するツール（例：Metasploit）を使用して、大規模なスキャンと攻撃を行います。

7. トラフィック分析：
   Wiresharkなどのツールを使用して、SNMPトラフィックを解析し、コミュニティ名や他の重要な情報を抽出します。

8. エスカレーション：
   取得した情報を基に、他のセキュリティ脆弱性を探索し、より高度な攻撃（例：特定のデバイスの既知の脆弱性を狙った攻撃）を仕掛けます。
