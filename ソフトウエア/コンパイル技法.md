[[言語プロセッサ#^fd52d4|コンパイラ]]は高水準言語で記述されたプログラムを機械語の目的プログラムに変換・翻訳する言語プロセッサ。
その処理手順は：


| 処理ステップ | 概要 | 具体的な例 |
| --- | --- | --- |
| 字句解析 (Lexical Analysis) | ソースコードを一連の意味のある最小トークン（識別子、キーワード、数値、文字列、演算子など）に分割します。これらのトークンは、言語の文法に従って解析されます。 | ソースコード（Python）: `print("Hello, world!")`<br>トークン化： `print`, `(`, `"Hello, world!"`, `)` |
| 構文解析 (Syntax Analysis) | トークンの順序をチェックし、それらがプログラミング言語の文法に従っていることを確認します。通常、このステップで構文木（パースツリー）が生成されます。 | トークン化： `print`, `(`, `"Hello, world!"`, `)`<br>パースツリー： `print`がルート、`(`と`)`が子、`"Hello, world!"`が孫となるツリー |
| 意味解析 (Semantic Analysis) | 構文解析の結果に基づき、コードが意味的に正しいかどうか（例：変数が宣言されているか、型が一致しているかなど）を確認します。 | パースツリーから、引数`"Hello, world!"`がprint関数に正しく渡されていることが確認されます。 |
| 最適化 (Optimization) | コードの効率を向上させるために行われるステップです。これには、不要な計算の削除、ループの最適化、インライン化などが含まれます。 | 例えば、コード`x = 3 + 4;`は最適化を行うと`x = 7;`に変換され、計算を省くことができます。 |
| コード生成 (Code Generation) | 最終的なマシン語のコード（またはバイトコードなど）を生成します。このステップで出力されるコードは、目的のマシンで直接実行可能な形式か、または別のステップ（例えばジャストインタイムコンパイル）を経て実行可能な形式になります。 | 最終的なバイナリコードは、具体的なマシンや環境によりますが、構文と意味解析で検出されたエラーがなければ、正しく実行できるはずです。 |

### コンパイラの最適化
コンパイラの最適化は主に二つの目標に基づいて行われます。一つは実行速度の最適化で、もう一つは生成されるコードのサイズの最適化です。両者は必ずしも同時に達成できるわけではありません。具体的に見ていきましょう。 ^9ad067

**実行速度の最適化:**

これらの最適化は、プログラムの実行速度を向上させることを目指しています。以下はその例です。

1. **ループの展開 (Loop Unrolling)**: ループの展開は、ループ内の命令の数を増やすことで、ループの反復回数を減らし、ループ制御にかかる時間を短縮します。しかし、これはコードのサイズを増やす可能性があります。
   ==容量++== ==時間--==
   ```python
for i in range(10):
    func(i) ^ae2240

for i in range(0, 10, 2):
    func(i)
    func(i+1)

```


2. **関数のインライン展開 (Inline Expansion)**: 関数呼び出しのオーバーヘッドを減らすために、小さな関数をその呼び出し元に直接挿入します。これもまたコードのサイズを増やす可能性があります。
   (関数を呼び出す側に呼び出される側の関数のコードを展開することで、関数呼び出しに伴う余分な制御処理を削減する最適化手法です。オブジェクトコードが展開される分だけオブジェクトコード量は増えます。)
   ==容量++== ==時間--==

3. **定数伝播 (Constant Propagation)**: コンパイラはプログラムの流れを通じて定数値を追跡し、これらの値を早期に計算します。これにより、実行時の計算量が減り、実行速度が向上します。
   ==時間--==
4. CPUでは乗算よりも加算の方が高速に計算できるので、冪算を乗算、乗算を加算に変換する。
   「演算子強度低減」と呼ばれる最適化が行われる。
   ==時間--==
5. 終始更新されない変数を定数に変換する。
   ==時間--==
6. ループ内不変式の移動は、ループ中で値の変化しない式があるとき、その式をループの外に移動することで実行速度を向上させる最適化手法です。位置を置き換えるだけなのでオブジェクトコード量は変化しません。
   ==時間--==

**コードサイズの最適化:**

これらの最適化は、生成されるコードのサイズを最小限にすることを目指しています。以下はその例です。

1. **デッドコードの除去 (Dead Code Elimination)**: 到達不可能なコード（例えば、常に偽となる条件分岐のブロックなど）は実行されないため、コードから除去します。
   ==容量--==

2. **共通部分式の除去 (Common Subexpression Elimination)**: 同じ計算が複数回行われている場合、その結果を再利用することで、コードの重複を排除します。
   ==容量--==

3. **木の最適化 (Tree Shaking)**: 使用されない関数や変数をプログラムから除去します。これにより、コードのサイズが削減されます。
   ==容量--==

4. **定数の畳み込み**:定数の畳込みは、定数同士の計算式を、その計算結果の定数に置き換えることでオブジェクトコード量を削減する最適化手法です。

以上手法の他に、変数をレジスタに割り当てるなどの手法がある。

^最適化
^1f62ad
